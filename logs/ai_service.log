INFO:     Will watch for changes in these directories: ['/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/ai_service']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [6708] using StatReload
INFO:     Started server process [6720]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:51757 - "GET /health HTTP/1.1" 200 OK
INFO:api.main:Geocoding place: London, UK
INFO:     127.0.0.1:51757 - "POST /api/geocode HTTP/1.1" 200 OK
INFO:api.main:Initializing questionnaire for birth date: 1990-01-01 00:00:00, time: 12:00
INFO:api.main:Generating birth chart for: 1990-01-01 00:00:00 12:00 at lat: 51.5074, lng: -0.1278
INFO:api.main:Generating AI question based on chart data and previous answers
INFO:api.main:Generated question: Do you consider yourself more introverted than extroverted?
INFO:api.main:Questionnaire initialized with session ID: 673b904d-2b8f-4bd4-855c-8948ae5e0202
INFO:api.main:Generated first question: Do you consider yourself more introverted than extroverted?
INFO:     127.0.0.1:51757 - "POST /api/initialize-questionnaire HTTP/1.1" 200 OK
INFO:     127.0.0.1:51858 - "GET /health HTTP/1.1" 200 OK
INFO:api.main:Geocoding place: London, UK
INFO:     127.0.0.1:51882 - "POST /api/geocode HTTP/1.1" 200 OK
INFO:api.main:Initializing questionnaire for birth date: 1990-01-01 00:00:00, time: 12:00
INFO:api.main:Generating birth chart for: 1990-01-01 00:00:00 12:00 at lat: 51.5074, lng: -0.1278
INFO:api.main:Generating AI question based on chart data and previous answers
INFO:api.main:Generated question: Do you consider yourself more introverted than extroverted?
INFO:api.main:Questionnaire initialized with session ID: 4a87d87b-6c78-493b-86e6-bc87baadb6cd
INFO:api.main:Generated first question: Do you consider yourself more introverted than extroverted?
INFO:     127.0.0.1:51882 - "POST /api/initialize-questionnaire HTTP/1.1" 200 OK
INFO:     127.0.0.1:51887 - "GET /health HTTP/1.1" 200 OK
INFO:api.main:Geocoding place: London, UK
INFO:     127.0.0.1:51887 - "POST /api/geocode HTTP/1.1" 200 OK
INFO:api.main:Initializing questionnaire for birth date: 1990-01-01 00:00:00, time: 12:00
INFO:api.main:Generating birth chart for: 1990-01-01 00:00:00 12:00 at lat: 51.5074, lng: -0.1278
INFO:api.main:Generating AI question based on chart data and previous answers
INFO:api.main:Generated question: Do you consider yourself more introverted than extroverted?
INFO:api.main:Questionnaire initialized with session ID: 2dfd9bf4-f287-43c7-98db-d3b47d2d90b2
INFO:api.main:Generated first question: Do you consider yourself more introverted than extroverted?
INFO:     127.0.0.1:51887 - "POST /api/initialize-questionnaire HTTP/1.1" 200 OK
INFO:api.main:Processing next question request for session: 2dfd9bf4-f287-43c7-98db-d3b47d2d90b2
INFO:api.main:Generating AI question based on chart data and previous answers
INFO:api.main:Generated question: Do you consider yourself more introverted than extroverted?
INFO:api.main:Generated next question for session 2dfd9bf4-f287-43c7-98db-d3b47d2d90b2: Do you consider yourself more introverted than extroverted?
INFO:     127.0.0.1:51887 - "POST /api/next-question HTTP/1.1" 200 OK
INFO:api.main:Retrieving analysis results for session: 2dfd9bf4-f287-43c7-98db-d3b47d2d90b2
INFO:api.main:Successfully retrieved analysis for session: 2dfd9bf4-f287-43c7-98db-d3b47d2d90b2
INFO:     127.0.0.1:51887 - "GET /api/analysis?sessionId=2dfd9bf4-f287-43c7-98db-d3b47d2d90b2 HTTP/1.1" 200 OK
INFO:ai_service.utils.astro_calculator:Calculating chart for birth_date=1990-01-01 12:00:00, lat=51.5074, lon=-0.1278
INFO:ai_service.utils.astro_calculator:Julian day: 2447893.0
INFO:ai_service.utils.astro_calculator:Swiss Ephemeris initialized successfully
ERROR:ai_service.utils.astro_calculator:Error calculating houses: cannot access local variable 'houses' where it is not associated with a value
INFO:ai_service.utils.astro_calculator:Calculating position for Sun (ID: 0)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Sun: ((280.81425544575603, 1.1985682564757624e-05, 0.9833280831730781, 1.01947310464201, 2.809760697245598e-05, -1.5098034370248692e-05), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (280.81425544575603, 1.1985682564757624e-05, 0.9833280831730781, 1.01947310464201, 2.809760697245598e-05, -1.5098034370248692e-05), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 280.81425544575603
INFO:ai_service.utils.astro_calculator:Normalized result: 280.81425544575603
INFO:ai_service.utils.astro_calculator:Sun longitude: 280.81425544575603
INFO:ai_service.utils.astro_calculator:Sun sign: Capricorn, degree: 10.814255445756032
INFO:ai_service.utils.astro_calculator:Sun house: 12
WARNING:root:Unexpected planet_info format for speed: ((280.81425544575603, 1.1985682564757624e-05, 0.9833280831730781, 1.01947310464201, 2.809760697245598e-05, -1.5098034370248692e-05), 260)
INFO:ai_service.utils.astro_calculator:Sun retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Moon (ID: 1)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Moon: ((333.26768767094467, 1.47068950903145, 0.0025351279509547115, 13.470100891939252, 1.1743239834064831, -1.979214879207882e-05), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (333.26768767094467, 1.47068950903145, 0.0025351279509547115, 13.470100891939252, 1.1743239834064831, -1.979214879207882e-05), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 333.26768767094467
INFO:ai_service.utils.astro_calculator:Normalized result: 333.26768767094467
INFO:ai_service.utils.astro_calculator:Moon longitude: 333.26768767094467
INFO:ai_service.utils.astro_calculator:Moon sign: Pisces, degree: 3.2676876709446674
INFO:ai_service.utils.astro_calculator:Moon house: 12
WARNING:root:Unexpected planet_info format for speed: ((333.26768767094467, 1.47068950903145, 0.0025351279509547115, 13.470100891939252, 1.1743239834064831, -1.979214879207882e-05), 260)
INFO:ai_service.utils.astro_calculator:Moon retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Mercury (ID: 2)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Mercury: ((295.6728045365972, 0.6303053479293252, 0.7711120890134723, -0.29457231280300367, 0.3134351991162652, -0.021861152206074905), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (295.6728045365972, 0.6303053479293252, 0.7711120890134723, -0.29457231280300367, 0.3134351991162652, -0.021861152206074905), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 295.6728045365972
INFO:ai_service.utils.astro_calculator:Normalized result: 295.6728045365972
INFO:ai_service.utils.astro_calculator:Mercury longitude: 295.6728045365972
INFO:ai_service.utils.astro_calculator:Mercury sign: Capricorn, degree: 25.672804536597198
INFO:ai_service.utils.astro_calculator:Mercury house: 12
WARNING:root:Unexpected planet_info format for speed: ((295.6728045365972, 0.6303053479293252, 0.7711120890134723, -0.29457231280300367, 0.3134351991162652, -0.021861152206074905), 260)
INFO:ai_service.utils.astro_calculator:Mercury retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Venus (ID: 3)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Venus: ((306.221833473402, 1.9011918260328955, 0.3054890730547468, -0.13028682883516793, 0.24595353822093885, -0.00427931435543599), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (306.221833473402, 1.9011918260328955, 0.3054890730547468, -0.13028682883516793, 0.24595353822093885, -0.00427931435543599), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 306.221833473402
INFO:ai_service.utils.astro_calculator:Normalized result: 306.221833473402
INFO:ai_service.utils.astro_calculator:Venus longitude: 306.221833473402
INFO:ai_service.utils.astro_calculator:Venus sign: Aquarius, degree: 6.221833473402
INFO:ai_service.utils.astro_calculator:Venus house: 12
WARNING:root:Unexpected planet_info format for speed: ((306.221833473402, 1.9011918260328955, 0.3054890730547468, -0.13028682883516793, 0.24595353822093885, -0.00427931435543599), 260)
INFO:ai_service.utils.astro_calculator:Venus retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Mars (ID: 4)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Mars: ((250.00008659833776, -0.03293101657371646, 2.3075926945854244, 0.7037567155774984, -0.010994010195469911, -0.005722596811260307), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (250.00008659833776, -0.03293101657371646, 2.3075926945854244, 0.7037567155774984, -0.010994010195469911, -0.005722596811260307), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 250.00008659833776
INFO:ai_service.utils.astro_calculator:Normalized result: 250.00008659833776
INFO:ai_service.utils.astro_calculator:Mars longitude: 250.00008659833776
INFO:ai_service.utils.astro_calculator:Mars sign: Sagittarius, degree: 10.00008659833776
INFO:ai_service.utils.astro_calculator:Mars house: 12
WARNING:root:Unexpected planet_info format for speed: ((250.00008659833776, -0.03293101657371646, 2.3075926945854244, 0.7037567155774984, -0.010994010195469911, -0.005722596811260307), 260)
INFO:ai_service.utils.astro_calculator:Mars retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Jupiter (ID: 5)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Jupiter: ((95.14872561927946, -0.11696028211365207, 4.171522546220324, -0.13448078212919967, 0.0024423931619051817, 0.0019538741503227156), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (95.14872561927946, -0.11696028211365207, 4.171522546220324, -0.13448078212919967, 0.0024423931619051817, 0.0019538741503227156), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 95.14872561927946
INFO:ai_service.utils.astro_calculator:Normalized result: 95.14872561927946
INFO:ai_service.utils.astro_calculator:Jupiter longitude: 95.14872561927946
INFO:ai_service.utils.astro_calculator:Jupiter sign: Cancer, degree: 5.14872561927946
INFO:ai_service.utils.astro_calculator:Jupiter house: 12
WARNING:root:Unexpected planet_info format for speed: ((95.14872561927946, -0.11696028211365207, 4.171522546220324, -0.13448078212919967, 0.0024423931619051817, 0.0019538741503227156), 260)
INFO:ai_service.utils.astro_calculator:Jupiter retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Saturn (ID: 6)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Saturn: ((285.6575220954597, 0.2933007711626002, 11.006571768028431, 0.11827135254681995, -0.0012295725143390015, 0.0013657353647093845), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (285.6575220954597, 0.2933007711626002, 11.006571768028431, 0.11827135254681995, -0.0012295725143390015, 0.0013657353647093845), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 285.6575220954597
INFO:ai_service.utils.astro_calculator:Normalized result: 285.6575220954597
INFO:ai_service.utils.astro_calculator:Saturn longitude: 285.6575220954597
INFO:ai_service.utils.astro_calculator:Saturn sign: Capricorn, degree: 15.657522095459683
INFO:ai_service.utils.astro_calculator:Saturn house: 12
WARNING:root:Unexpected planet_info format for speed: ((285.6575220954597, 0.2933007711626002, 11.006571768028431, 0.11827135254681995, -0.0012295725143390015, 0.0013657353647093845), 260)
INFO:ai_service.utils.astro_calculator:Saturn retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Uranus (ID: 7)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Uranus: ((275.78547525004376, -0.27010758490767717, 20.35945699822529, 0.06000821979893455, -0.00016580147976099987, -0.0013166990470305866), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (275.78547525004376, -0.27010758490767717, 20.35945699822529, 0.06000821979893455, -0.00016580147976099987, -0.0013166990470305866), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 275.78547525004376
INFO:ai_service.utils.astro_calculator:Normalized result: 275.78547525004376
INFO:ai_service.utils.astro_calculator:Uranus longitude: 275.78547525004376
INFO:ai_service.utils.astro_calculator:Uranus sign: Capricorn, degree: 5.78547525004376
INFO:ai_service.utils.astro_calculator:Uranus house: 12
WARNING:root:Unexpected planet_info format for speed: ((275.78547525004376, -0.27010758490767717, 20.35945699822529, 0.06000821979893455, -0.00016580147976099987, -0.0013166990470305866), 260)
INFO:ai_service.utils.astro_calculator:Uranus retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Neptune (ID: 8)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Neptune: ((282.0381195937746, 0.8473535347432745, 31.19343142190719, 0.037911024452963356, -0.0001221630818358851, 0.0003880732570147815), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (282.0381195937746, 0.8473535347432745, 31.19343142190719, 0.037911024452963356, -0.0001221630818358851, 0.0003880732570147815), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 282.0381195937746
INFO:ai_service.utils.astro_calculator:Normalized result: 282.0381195937746
INFO:ai_service.utils.astro_calculator:Neptune longitude: 282.0381195937746
INFO:ai_service.utils.astro_calculator:Neptune sign: Capricorn, degree: 12.038119593774582
INFO:ai_service.utils.astro_calculator:Neptune house: 12
WARNING:root:Unexpected planet_info format for speed: ((282.0381195937746, 0.8473535347432745, 31.19343142190719, 0.037911024452963356, -0.0001221630818358851, 0.0003880732570147815), 260)
INFO:ai_service.utils.astro_calculator:Neptune retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Pluto (ID: 9)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Pluto: ((227.09316655077527, 15.28442092654024, 30.206517889657466, 0.02732340680896378, 0.006139322442282221, -0.013477109937381758), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (227.09316655077527, 15.28442092654024, 30.206517889657466, 0.02732340680896378, 0.006139322442282221, -0.013477109937381758), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 227.09316655077527
INFO:ai_service.utils.astro_calculator:Normalized result: 227.09316655077527
INFO:ai_service.utils.astro_calculator:Pluto longitude: 227.09316655077527
INFO:ai_service.utils.astro_calculator:Pluto sign: Scorpio, degree: 17.093166550775265
INFO:ai_service.utils.astro_calculator:Pluto house: 12
WARNING:root:Unexpected planet_info format for speed: ((227.09316655077527, 15.28442092654024, 30.206517889657466, 0.02732340680896378, 0.006139322442282221, -0.013477109937381758), 260)
INFO:ai_service.utils.astro_calculator:Pluto retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Rahu (ID: 10)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Rahu: ((318.4349837113926, 0.0, 0.00256955528979999, -0.052959402172705644, 0.0, 0.0), 258)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (318.4349837113926, 0.0, 0.00256955528979999, -0.052959402172705644, 0.0, 0.0), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 318.4349837113926
INFO:ai_service.utils.astro_calculator:Normalized result: 318.4349837113926
INFO:ai_service.utils.astro_calculator:Rahu longitude: 318.4349837113926
INFO:ai_service.utils.astro_calculator:Rahu sign: Aquarius, degree: 18.43498371139259
INFO:ai_service.utils.astro_calculator:Rahu house: 12
WARNING:root:Unexpected planet_info format for speed: ((318.4349837113926, 0.0, 0.00256955528979999, -0.052959402172705644, 0.0, 0.0), 258)
INFO:ai_service.utils.astro_calculator:Rahu retrograde: False
INFO:ai_service.utils.astro_calculator:Normalizing degrees: 498.4349837113926, type: <class 'float'>
INFO:ai_service.utils.astro_calculator:Normalized result: 138.4349837113926
WARNING:api.main:Using simplified D1 chart due to error: 1 validation error for AspectData
aspect_type
  Field required [type=missing, input_value={'planet1': 'Sun', 'plane...etween Sun and Jupiter'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
INFO:     127.0.0.1:51887 - "POST /api/charts HTTP/1.1" 200 OK
INFO:     127.0.0.1:52041 - "GET /health HTTP/1.1" 200 OK
INFO:api.main:Geocoding place: London, UK
INFO:     127.0.0.1:52041 - "POST /api/geocode HTTP/1.1" 200 OK
INFO:api.main:Initializing questionnaire for birth date: 1990-01-01 00:00:00, time: 12:00
INFO:api.main:Generating birth chart for: 1990-01-01 00:00:00 12:00 at lat: 51.5074, lng: -0.1278
INFO:api.main:Generating AI question based on chart data and previous answers
INFO:api.main:Generated question: Do you consider yourself more introverted than extroverted?
INFO:api.main:Questionnaire initialized with session ID: 5edf49bc-a443-48e5-b03b-02235a1bde1d
INFO:api.main:Generated first question: Do you consider yourself more introverted than extroverted?
INFO:     127.0.0.1:52041 - "POST /api/initialize-questionnaire HTTP/1.1" 200 OK
INFO:api.main:Processing next question request for session: 5edf49bc-a443-48e5-b03b-02235a1bde1d
INFO:api.main:Generating AI question based on chart data and previous answers
INFO:api.main:Generated question: Do you consider yourself more introverted than extroverted?
INFO:api.main:Generated next question for session 5edf49bc-a443-48e5-b03b-02235a1bde1d: Do you consider yourself more introverted than extroverted?
INFO:     127.0.0.1:52041 - "POST /api/next-question HTTP/1.1" 200 OK
INFO:api.main:Retrieving analysis results for session: 5edf49bc-a443-48e5-b03b-02235a1bde1d
INFO:api.main:Successfully retrieved analysis for session: 5edf49bc-a443-48e5-b03b-02235a1bde1d
INFO:     127.0.0.1:52041 - "GET /api/analysis?sessionId=5edf49bc-a443-48e5-b03b-02235a1bde1d HTTP/1.1" 200 OK
INFO:ai_service.utils.astro_calculator:Calculating chart for birth_date=1990-01-01 12:00:00, lat=51.5074, lon=-0.1278
INFO:ai_service.utils.astro_calculator:Julian day: 2447893.0
INFO:ai_service.utils.astro_calculator:Swiss Ephemeris initialized successfully
ERROR:ai_service.utils.astro_calculator:Error calculating houses: cannot access local variable 'houses' where it is not associated with a value
INFO:ai_service.utils.astro_calculator:Calculating position for Sun (ID: 0)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Sun: ((280.81425544575603, 1.1985682564757624e-05, 0.9833280831730781, 1.01947310464201, 2.809760697245598e-05, -1.5098034370248692e-05), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (280.81425544575603, 1.1985682564757624e-05, 0.9833280831730781, 1.01947310464201, 2.809760697245598e-05, -1.5098034370248692e-05), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 280.81425544575603
INFO:ai_service.utils.astro_calculator:Normalized result: 280.81425544575603
INFO:ai_service.utils.astro_calculator:Sun longitude: 280.81425544575603
INFO:ai_service.utils.astro_calculator:Sun sign: Capricorn, degree: 10.814255445756032
INFO:ai_service.utils.astro_calculator:Sun house: 12
WARNING:root:Unexpected planet_info format for speed: ((280.81425544575603, 1.1985682564757624e-05, 0.9833280831730781, 1.01947310464201, 2.809760697245598e-05, -1.5098034370248692e-05), 260)
INFO:ai_service.utils.astro_calculator:Sun retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Moon (ID: 1)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Moon: ((333.26768767094467, 1.47068950903145, 0.0025351279509547115, 13.470100891939252, 1.1743239834064831, -1.979214879207882e-05), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (333.26768767094467, 1.47068950903145, 0.0025351279509547115, 13.470100891939252, 1.1743239834064831, -1.979214879207882e-05), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 333.26768767094467
INFO:ai_service.utils.astro_calculator:Normalized result: 333.26768767094467
INFO:ai_service.utils.astro_calculator:Moon longitude: 333.26768767094467
INFO:ai_service.utils.astro_calculator:Moon sign: Pisces, degree: 3.2676876709446674
INFO:ai_service.utils.astro_calculator:Moon house: 12
WARNING:root:Unexpected planet_info format for speed: ((333.26768767094467, 1.47068950903145, 0.0025351279509547115, 13.470100891939252, 1.1743239834064831, -1.979214879207882e-05), 260)
INFO:ai_service.utils.astro_calculator:Moon retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Mercury (ID: 2)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Mercury: ((295.6728045365972, 0.6303053479293252, 0.7711120890134723, -0.29457231280300367, 0.3134351991162652, -0.021861152206074905), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (295.6728045365972, 0.6303053479293252, 0.7711120890134723, -0.29457231280300367, 0.3134351991162652, -0.021861152206074905), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 295.6728045365972
INFO:ai_service.utils.astro_calculator:Normalized result: 295.6728045365972
INFO:ai_service.utils.astro_calculator:Mercury longitude: 295.6728045365972
INFO:ai_service.utils.astro_calculator:Mercury sign: Capricorn, degree: 25.672804536597198
INFO:ai_service.utils.astro_calculator:Mercury house: 12
WARNING:root:Unexpected planet_info format for speed: ((295.6728045365972, 0.6303053479293252, 0.7711120890134723, -0.29457231280300367, 0.3134351991162652, -0.021861152206074905), 260)
INFO:ai_service.utils.astro_calculator:Mercury retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Venus (ID: 3)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Venus: ((306.221833473402, 1.9011918260328955, 0.3054890730547468, -0.13028682883516793, 0.24595353822093885, -0.00427931435543599), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (306.221833473402, 1.9011918260328955, 0.3054890730547468, -0.13028682883516793, 0.24595353822093885, -0.00427931435543599), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 306.221833473402
INFO:ai_service.utils.astro_calculator:Normalized result: 306.221833473402
INFO:ai_service.utils.astro_calculator:Venus longitude: 306.221833473402
INFO:ai_service.utils.astro_calculator:Venus sign: Aquarius, degree: 6.221833473402
INFO:ai_service.utils.astro_calculator:Venus house: 12
WARNING:root:Unexpected planet_info format for speed: ((306.221833473402, 1.9011918260328955, 0.3054890730547468, -0.13028682883516793, 0.24595353822093885, -0.00427931435543599), 260)
INFO:ai_service.utils.astro_calculator:Venus retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Mars (ID: 4)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Mars: ((250.00008659833776, -0.03293101657371646, 2.3075926945854244, 0.7037567155774984, -0.010994010195469911, -0.005722596811260307), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (250.00008659833776, -0.03293101657371646, 2.3075926945854244, 0.7037567155774984, -0.010994010195469911, -0.005722596811260307), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 250.00008659833776
INFO:ai_service.utils.astro_calculator:Normalized result: 250.00008659833776
INFO:ai_service.utils.astro_calculator:Mars longitude: 250.00008659833776
INFO:ai_service.utils.astro_calculator:Mars sign: Sagittarius, degree: 10.00008659833776
INFO:ai_service.utils.astro_calculator:Mars house: 12
WARNING:root:Unexpected planet_info format for speed: ((250.00008659833776, -0.03293101657371646, 2.3075926945854244, 0.7037567155774984, -0.010994010195469911, -0.005722596811260307), 260)
INFO:ai_service.utils.astro_calculator:Mars retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Jupiter (ID: 5)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Jupiter: ((95.14872561927946, -0.11696028211365207, 4.171522546220324, -0.13448078212919967, 0.0024423931619051817, 0.0019538741503227156), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (95.14872561927946, -0.11696028211365207, 4.171522546220324, -0.13448078212919967, 0.0024423931619051817, 0.0019538741503227156), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 95.14872561927946
INFO:ai_service.utils.astro_calculator:Normalized result: 95.14872561927946
INFO:ai_service.utils.astro_calculator:Jupiter longitude: 95.14872561927946
INFO:ai_service.utils.astro_calculator:Jupiter sign: Cancer, degree: 5.14872561927946
INFO:ai_service.utils.astro_calculator:Jupiter house: 12
WARNING:root:Unexpected planet_info format for speed: ((95.14872561927946, -0.11696028211365207, 4.171522546220324, -0.13448078212919967, 0.0024423931619051817, 0.0019538741503227156), 260)
INFO:ai_service.utils.astro_calculator:Jupiter retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Saturn (ID: 6)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Saturn: ((285.6575220954597, 0.2933007711626002, 11.006571768028431, 0.11827135254681995, -0.0012295725143390015, 0.0013657353647093845), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (285.6575220954597, 0.2933007711626002, 11.006571768028431, 0.11827135254681995, -0.0012295725143390015, 0.0013657353647093845), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 285.6575220954597
INFO:ai_service.utils.astro_calculator:Normalized result: 285.6575220954597
INFO:ai_service.utils.astro_calculator:Saturn longitude: 285.6575220954597
INFO:ai_service.utils.astro_calculator:Saturn sign: Capricorn, degree: 15.657522095459683
INFO:ai_service.utils.astro_calculator:Saturn house: 12
WARNING:root:Unexpected planet_info format for speed: ((285.6575220954597, 0.2933007711626002, 11.006571768028431, 0.11827135254681995, -0.0012295725143390015, 0.0013657353647093845), 260)
INFO:ai_service.utils.astro_calculator:Saturn retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Uranus (ID: 7)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Uranus: ((275.78547525004376, -0.27010758490767717, 20.35945699822529, 0.06000821979893455, -0.00016580147976099987, -0.0013166990470305866), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (275.78547525004376, -0.27010758490767717, 20.35945699822529, 0.06000821979893455, -0.00016580147976099987, -0.0013166990470305866), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 275.78547525004376
INFO:ai_service.utils.astro_calculator:Normalized result: 275.78547525004376
INFO:ai_service.utils.astro_calculator:Uranus longitude: 275.78547525004376
INFO:ai_service.utils.astro_calculator:Uranus sign: Capricorn, degree: 5.78547525004376
INFO:ai_service.utils.astro_calculator:Uranus house: 12
WARNING:root:Unexpected planet_info format for speed: ((275.78547525004376, -0.27010758490767717, 20.35945699822529, 0.06000821979893455, -0.00016580147976099987, -0.0013166990470305866), 260)
INFO:ai_service.utils.astro_calculator:Uranus retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Neptune (ID: 8)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Neptune: ((282.0381195937746, 0.8473535347432745, 31.19343142190719, 0.037911024452963356, -0.0001221630818358851, 0.0003880732570147815), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (282.0381195937746, 0.8473535347432745, 31.19343142190719, 0.037911024452963356, -0.0001221630818358851, 0.0003880732570147815), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 282.0381195937746
INFO:ai_service.utils.astro_calculator:Normalized result: 282.0381195937746
INFO:ai_service.utils.astro_calculator:Neptune longitude: 282.0381195937746
INFO:ai_service.utils.astro_calculator:Neptune sign: Capricorn, degree: 12.038119593774582
INFO:ai_service.utils.astro_calculator:Neptune house: 12
WARNING:root:Unexpected planet_info format for speed: ((282.0381195937746, 0.8473535347432745, 31.19343142190719, 0.037911024452963356, -0.0001221630818358851, 0.0003880732570147815), 260)
INFO:ai_service.utils.astro_calculator:Neptune retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Pluto (ID: 9)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Pluto: ((227.09316655077527, 15.28442092654024, 30.206517889657466, 0.02732340680896378, 0.006139322442282221, -0.013477109937381758), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (227.09316655077527, 15.28442092654024, 30.206517889657466, 0.02732340680896378, 0.006139322442282221, -0.013477109937381758), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 227.09316655077527
INFO:ai_service.utils.astro_calculator:Normalized result: 227.09316655077527
INFO:ai_service.utils.astro_calculator:Pluto longitude: 227.09316655077527
INFO:ai_service.utils.astro_calculator:Pluto sign: Scorpio, degree: 17.093166550775265
INFO:ai_service.utils.astro_calculator:Pluto house: 12
WARNING:root:Unexpected planet_info format for speed: ((227.09316655077527, 15.28442092654024, 30.206517889657466, 0.02732340680896378, 0.006139322442282221, -0.013477109937381758), 260)
INFO:ai_service.utils.astro_calculator:Pluto retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Rahu (ID: 10)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Rahu: ((318.4349837113926, 0.0, 0.00256955528979999, -0.052959402172705644, 0.0, 0.0), 258)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (318.4349837113926, 0.0, 0.00256955528979999, -0.052959402172705644, 0.0, 0.0), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 318.4349837113926
INFO:ai_service.utils.astro_calculator:Normalized result: 318.4349837113926
INFO:ai_service.utils.astro_calculator:Rahu longitude: 318.4349837113926
INFO:ai_service.utils.astro_calculator:Rahu sign: Aquarius, degree: 18.43498371139259
INFO:ai_service.utils.astro_calculator:Rahu house: 12
WARNING:root:Unexpected planet_info format for speed: ((318.4349837113926, 0.0, 0.00256955528979999, -0.052959402172705644, 0.0, 0.0), 258)
INFO:ai_service.utils.astro_calculator:Rahu retrograde: False
INFO:ai_service.utils.astro_calculator:Normalizing degrees: 498.4349837113926, type: <class 'float'>
INFO:ai_service.utils.astro_calculator:Normalized result: 138.4349837113926
WARNING:api.main:Using simplified D1 chart due to error: 1 validation error for AspectData
aspect_type
  Field required [type=missing, input_value={'planet1': 'Sun', 'plane...etween Sun and Jupiter'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
INFO:     127.0.0.1:52041 - "POST /api/charts HTTP/1.1" 200 OK
INFO:     127.0.0.1:52044 - "GET /health HTTP/1.1" 200 OK
INFO:api.main:Geocoding place: London, UK
INFO:     127.0.0.1:52044 - "POST /api/geocode HTTP/1.1" 200 OK
INFO:api.main:Initializing questionnaire for birth date: 1990-01-01 00:00:00, time: 12:00
INFO:api.main:Generating birth chart for: 1990-01-01 00:00:00 12:00 at lat: 51.5074, lng: -0.1278
INFO:api.main:Generating AI question based on chart data and previous answers
INFO:api.main:Generated question: Do you consider yourself more introverted than extroverted?
INFO:api.main:Questionnaire initialized with session ID: 0b5e517f-7c47-416c-bbad-44d609d66a3e
INFO:api.main:Generated first question: Do you consider yourself more introverted than extroverted?
INFO:     127.0.0.1:52044 - "POST /api/initialize-questionnaire HTTP/1.1" 200 OK
Traceback (most recent call last):
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/bin/uvicorn", line 8, in <module>
    sys.exit(main())
             ~~~~^^
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/click/core.py", line 1161, in __call__
    return self.main(*args, **kwargs)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/click/core.py", line 1082, in main
    rv = self.invoke(ctx)
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/click/core.py", line 1443, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/click/core.py", line 788, in invoke
    return __callback(*args, **kwargs)
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/uvicorn/main.py", line 412, in main
    run(
    ~~~^
        app,
        ^^^^
    ...<45 lines>...
        h11_max_incomplete_event_size=h11_max_incomplete_event_size,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/uvicorn/main.py", line 579, in run
    server.run()
    ~~~~~~~~~~^^
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 70, in serve
    await self._serve(sockets)
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/uvicorn/server.py", line 77, in _serve
    config.load()
    ~~~~~~~~~~~^^
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/uvicorn/config.py", line 435, in load
    self.loaded_app = import_from_string(self.app)
                      ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/uvicorn/importer.py", line 22, in import_from_string
    raise exc from None
  File "/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1310, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'api'
INFO:ai_service.utils.astro_calculator:Swiss Ephemeris initialized
INFO:     Started server process [19577]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     127.0.0.1:54682 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:54685 - "GET /health HTTP/1.1" 200 OK
INFO:ai_service.utils.astro_calculator:Swiss Ephemeris initialized
INFO:     Started server process [19862]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     127.0.0.1:54817 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:54820 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:54834 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57894 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57896 - "POST /api/questionnaire/initialize HTTP/1.1" 404 Not Found
/Users/Shared/cursor/Containerised-Birth-Time-Recitfier/.venv/lib/python3.13/site-packages/fastapi/openapi/utils.py:225: UserWarning: Duplicate Operation ID generate_charts_api_charts_post for function generate_charts at /Users/Shared/cursor/Containerised-Birth-Time-Recitfier/ai_service/api/routers/charts.py
  warnings.warn(message, stacklevel=1)
INFO:     127.0.0.1:57898 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:ai_service.utils.astro_calculator:Calculating chart for birth_date=1990-01-01 12:00:00, lat=0.0, lon=0.0
INFO:ai_service.utils.astro_calculator:Julian day: 2447893.0
INFO:ai_service.utils.astro_calculator:Swiss Ephemeris initialized successfully
INFO:ai_service.utils.astro_calculator:House cusps calculated: (11.831741604799397, 43.334014065097165, 72.35582431353075, 100.00039853909266, 128.45499091080592, 159.29984183171007, 191.8317416047994, 223.33401406509716, 252.35582431353075, 280.00039853909266, 308.4549909108059, 339.29984183171007)
INFO:ai_service.utils.astro_calculator:Ascendant: 11.831741604799397, Sign: Aries, Degree: 11.831741604799397, Midheaven: 280.00039853909266
INFO:ai_service.utils.astro_calculator:Calculating position for Sun (ID: 0)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Sun: ((280.81425544575603, 1.1985682564757624e-05, 0.9833280831730781, 1.01947310464201, 2.809760697245598e-05, -1.5098034370248692e-05), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (280.81425544575603, 1.1985682564757624e-05, 0.9833280831730781, 1.01947310464201, 2.809760697245598e-05, -1.5098034370248692e-05), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 280.81425544575603
INFO:ai_service.utils.astro_calculator:Normalized result: 280.81425544575603
INFO:ai_service.utils.astro_calculator:Sun longitude: 280.81425544575603
INFO:ai_service.utils.astro_calculator:Sun sign: Capricorn, degree: 10.814255445756032
INFO:ai_service.utils.astro_calculator:Sun house: 10
WARNING:root:Unexpected planet_info format for speed: ((280.81425544575603, 1.1985682564757624e-05, 0.9833280831730781, 1.01947310464201, 2.809760697245598e-05, -1.5098034370248692e-05), 260)
INFO:ai_service.utils.astro_calculator:Sun retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Moon (ID: 1)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Moon: ((333.26768767094467, 1.47068950903145, 0.0025351279509547115, 13.470100891939252, 1.1743239834064831, -1.979214879207882e-05), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (333.26768767094467, 1.47068950903145, 0.0025351279509547115, 13.470100891939252, 1.1743239834064831, -1.979214879207882e-05), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 333.26768767094467
INFO:ai_service.utils.astro_calculator:Normalized result: 333.26768767094467
INFO:ai_service.utils.astro_calculator:Moon longitude: 333.26768767094467
INFO:ai_service.utils.astro_calculator:Moon sign: Pisces, degree: 3.2676876709446674
INFO:ai_service.utils.astro_calculator:Moon house: 11
WARNING:root:Unexpected planet_info format for speed: ((333.26768767094467, 1.47068950903145, 0.0025351279509547115, 13.470100891939252, 1.1743239834064831, -1.979214879207882e-05), 260)
INFO:ai_service.utils.astro_calculator:Moon retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Mercury (ID: 2)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Mercury: ((295.6728045365972, 0.6303053479293252, 0.7711120890134723, -0.29457231280300367, 0.3134351991162652, -0.021861152206074905), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (295.6728045365972, 0.6303053479293252, 0.7711120890134723, -0.29457231280300367, 0.3134351991162652, -0.021861152206074905), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 295.6728045365972
INFO:ai_service.utils.astro_calculator:Normalized result: 295.6728045365972
INFO:ai_service.utils.astro_calculator:Mercury longitude: 295.6728045365972
INFO:ai_service.utils.astro_calculator:Mercury sign: Capricorn, degree: 25.672804536597198
INFO:ai_service.utils.astro_calculator:Mercury house: 10
WARNING:root:Unexpected planet_info format for speed: ((295.6728045365972, 0.6303053479293252, 0.7711120890134723, -0.29457231280300367, 0.3134351991162652, -0.021861152206074905), 260)
INFO:ai_service.utils.astro_calculator:Mercury retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Venus (ID: 3)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Venus: ((306.221833473402, 1.9011918260328955, 0.3054890730547468, -0.13028682883516793, 0.24595353822093885, -0.00427931435543599), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (306.221833473402, 1.9011918260328955, 0.3054890730547468, -0.13028682883516793, 0.24595353822093885, -0.00427931435543599), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 306.221833473402
INFO:ai_service.utils.astro_calculator:Normalized result: 306.221833473402
INFO:ai_service.utils.astro_calculator:Venus longitude: 306.221833473402
INFO:ai_service.utils.astro_calculator:Venus sign: Aquarius, degree: 6.221833473402
INFO:ai_service.utils.astro_calculator:Venus house: 10
WARNING:root:Unexpected planet_info format for speed: ((306.221833473402, 1.9011918260328955, 0.3054890730547468, -0.13028682883516793, 0.24595353822093885, -0.00427931435543599), 260)
INFO:ai_service.utils.astro_calculator:Venus retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Mars (ID: 4)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Mars: ((250.00008659833776, -0.03293101657371646, 2.3075926945854244, 0.7037567155774984, -0.010994010195469911, -0.005722596811260307), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (250.00008659833776, -0.03293101657371646, 2.3075926945854244, 0.7037567155774984, -0.010994010195469911, -0.005722596811260307), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 250.00008659833776
INFO:ai_service.utils.astro_calculator:Normalized result: 250.00008659833776
INFO:ai_service.utils.astro_calculator:Mars longitude: 250.00008659833776
INFO:ai_service.utils.astro_calculator:Mars sign: Sagittarius, degree: 10.00008659833776
INFO:ai_service.utils.astro_calculator:Mars house: 8
WARNING:root:Unexpected planet_info format for speed: ((250.00008659833776, -0.03293101657371646, 2.3075926945854244, 0.7037567155774984, -0.010994010195469911, -0.005722596811260307), 260)
INFO:ai_service.utils.astro_calculator:Mars retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Jupiter (ID: 5)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Jupiter: ((95.14872561927946, -0.11696028211365207, 4.171522546220324, -0.13448078212919967, 0.0024423931619051817, 0.0019538741503227156), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (95.14872561927946, -0.11696028211365207, 4.171522546220324, -0.13448078212919967, 0.0024423931619051817, 0.0019538741503227156), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 95.14872561927946
INFO:ai_service.utils.astro_calculator:Normalized result: 95.14872561927946
INFO:ai_service.utils.astro_calculator:Jupiter longitude: 95.14872561927946
INFO:ai_service.utils.astro_calculator:Jupiter sign: Cancer, degree: 5.14872561927946
INFO:ai_service.utils.astro_calculator:Jupiter house: 3
WARNING:root:Unexpected planet_info format for speed: ((95.14872561927946, -0.11696028211365207, 4.171522546220324, -0.13448078212919967, 0.0024423931619051817, 0.0019538741503227156), 260)
INFO:ai_service.utils.astro_calculator:Jupiter retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Saturn (ID: 6)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Saturn: ((285.6575220954597, 0.2933007711626002, 11.006571768028431, 0.11827135254681995, -0.0012295725143390015, 0.0013657353647093845), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (285.6575220954597, 0.2933007711626002, 11.006571768028431, 0.11827135254681995, -0.0012295725143390015, 0.0013657353647093845), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 285.6575220954597
INFO:ai_service.utils.astro_calculator:Normalized result: 285.6575220954597
INFO:ai_service.utils.astro_calculator:Saturn longitude: 285.6575220954597
INFO:ai_service.utils.astro_calculator:Saturn sign: Capricorn, degree: 15.657522095459683
INFO:ai_service.utils.astro_calculator:Saturn house: 10
WARNING:root:Unexpected planet_info format for speed: ((285.6575220954597, 0.2933007711626002, 11.006571768028431, 0.11827135254681995, -0.0012295725143390015, 0.0013657353647093845), 260)
INFO:ai_service.utils.astro_calculator:Saturn retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Uranus (ID: 7)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Uranus: ((275.78547525004376, -0.27010758490767717, 20.35945699822529, 0.06000821979893455, -0.00016580147976099987, -0.0013166990470305866), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (275.78547525004376, -0.27010758490767717, 20.35945699822529, 0.06000821979893455, -0.00016580147976099987, -0.0013166990470305866), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 275.78547525004376
INFO:ai_service.utils.astro_calculator:Normalized result: 275.78547525004376
INFO:ai_service.utils.astro_calculator:Uranus longitude: 275.78547525004376
INFO:ai_service.utils.astro_calculator:Uranus sign: Capricorn, degree: 5.78547525004376
INFO:ai_service.utils.astro_calculator:Uranus house: 9
WARNING:root:Unexpected planet_info format for speed: ((275.78547525004376, -0.27010758490767717, 20.35945699822529, 0.06000821979893455, -0.00016580147976099987, -0.0013166990470305866), 260)
INFO:ai_service.utils.astro_calculator:Uranus retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Neptune (ID: 8)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Neptune: ((282.0381195937746, 0.8473535347432745, 31.19343142190719, 0.037911024452963356, -0.0001221630818358851, 0.0003880732570147815), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (282.0381195937746, 0.8473535347432745, 31.19343142190719, 0.037911024452963356, -0.0001221630818358851, 0.0003880732570147815), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 282.0381195937746
INFO:ai_service.utils.astro_calculator:Normalized result: 282.0381195937746
INFO:ai_service.utils.astro_calculator:Neptune longitude: 282.0381195937746
INFO:ai_service.utils.astro_calculator:Neptune sign: Capricorn, degree: 12.038119593774582
INFO:ai_service.utils.astro_calculator:Neptune house: 10
WARNING:root:Unexpected planet_info format for speed: ((282.0381195937746, 0.8473535347432745, 31.19343142190719, 0.037911024452963356, -0.0001221630818358851, 0.0003880732570147815), 260)
INFO:ai_service.utils.astro_calculator:Neptune retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Pluto (ID: 9)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Pluto: ((227.09316655077527, 15.28442092654024, 30.206517889657466, 0.02732340680896378, 0.006139322442282221, -0.013477109937381758), 260)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (227.09316655077527, 15.28442092654024, 30.206517889657466, 0.02732340680896378, 0.006139322442282221, -0.013477109937381758), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 227.09316655077527
INFO:ai_service.utils.astro_calculator:Normalized result: 227.09316655077527
INFO:ai_service.utils.astro_calculator:Pluto longitude: 227.09316655077527
INFO:ai_service.utils.astro_calculator:Pluto sign: Scorpio, degree: 17.093166550775265
INFO:ai_service.utils.astro_calculator:Pluto house: 8
WARNING:root:Unexpected planet_info format for speed: ((227.09316655077527, 15.28442092654024, 30.206517889657466, 0.02732340680896378, 0.006139322442282221, -0.013477109937381758), 260)
INFO:ai_service.utils.astro_calculator:Pluto retrograde: False
INFO:ai_service.utils.astro_calculator:Calculating position for Rahu (ID: 10)
INFO:ai_service.utils.astro_calculator:Raw calculation result for Rahu: ((318.4349837113926, 0.0, 0.00256955528979999, -0.052959402172705644, 0.0, 0.0), 258)
INFO:ai_service.utils.astro_calculator:Normalizing degrees: (318.4349837113926, 0.0, 0.00256955528979999, -0.052959402172705644, 0.0, 0.0), type: <class 'tuple'>
INFO:ai_service.utils.astro_calculator:Extracted from tuple: 318.4349837113926
INFO:ai_service.utils.astro_calculator:Normalized result: 318.4349837113926
INFO:ai_service.utils.astro_calculator:Rahu longitude: 318.4349837113926
INFO:ai_service.utils.astro_calculator:Rahu sign: Aquarius, degree: 18.43498371139259
INFO:ai_service.utils.astro_calculator:Rahu house: 11
WARNING:root:Unexpected planet_info format for speed: ((318.4349837113926, 0.0, 0.00256955528979999, -0.052959402172705644, 0.0, 0.0), 258)
INFO:ai_service.utils.astro_calculator:Rahu retrograde: False
INFO:ai_service.utils.astro_calculator:Normalizing degrees: 498.4349837113926, type: <class 'float'>
INFO:ai_service.utils.astro_calculator:Normalized result: 138.4349837113926
INFO:     127.0.0.1:57904 - "POST /api/questionnaire/generate HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:ai_service.api.main:Application shutdown, resources cleaned up
INFO:     Application shutdown complete.
INFO:     Finished server process [19862]
2025-03-05 21:22:57,681 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-05 21:23:07,661 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 00:19:27,853 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:27,858 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:27,858 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:27,858 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:27,858 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:27,858 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:27,859 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:27,863 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:27,867 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:27,867 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:27,867 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:27,867 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:27,868 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 00:19:27,869 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 00:19:27,870 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 00:19:27,870 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:27,880 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:27,880 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:27,880 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:27,880 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:27,880 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:27,883 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:27,888 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:27,888 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:27,888 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:27,888 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:27,888 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:27,889 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:27,895 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:27,896 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:27,896 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:27,896 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:27,896 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:27,898 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:27,903 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:27,904 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:27,904 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:27,904 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:27,904 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:27,905 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 00:19:27,906 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:27,913 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:27,913 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:27,913 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:27,914 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:27,914 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:27,918 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:27,923 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:27,923 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:27,923 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:27,923 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:27,923 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:42,342 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:19:51,004 - root - INFO - Running in local environment
2025-03-06 00:19:51,005 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 00:19:53,621 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 00:19:53,624 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 00:19:53,625 - ai_service.api.routers.ai_integration_test - ERROR - Error in test_model_routing: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 00:19:53,631 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 500 Internal Server Error"
2025-03-06 00:19:53,683 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 00:19:53,688 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:19:53,689 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:53,694 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:53,694 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:53,694 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:53,694 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:53,694 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:53,695 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:53,699 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:53,699 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:53,699 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:53,699 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:53,699 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:53,701 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 00:19:53,703 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 00:19:53,703 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 00:19:53,704 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:53,708 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:53,708 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:53,708 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:53,708 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:53,708 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:53,712 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:53,716 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:53,716 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:53,717 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:53,717 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:53,717 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:53,718 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:53,722 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:53,722 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:53,722 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:53,723 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:53,723 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:53,723 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:53,728 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:53,728 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:53,728 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:53,728 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:53,728 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:53,730 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 00:19:53,730 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:53,735 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:53,735 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:53,736 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:53,736 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:53,736 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:53,742 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:19:53,746 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:19:53,747 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:19:53,747 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:19:53,747 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:19:53,747 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:19:53,752 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 00:19:53,754 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 00:19:53,757 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 00:19:55,407 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 00:19:55,443 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 00:19:55,530 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 200 OK"
2025-03-06 00:19:55,561 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 00:19:55,601 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:19:55,713 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:19:55,761 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:19:55,827 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:19:55,850 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:19:55,873 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:19:55,901 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:19:56,384 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 00:19:56,409 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 404 Not Found"
2025-03-06 00:19:56,441 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 404 Not Found"
2025-03-06 00:19:56,472 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 404 Not Found"
2025-03-06 00:19:56,538 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 00:19:56,849 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 00:20:30,753 - root - INFO - Running in local environment
2025-03-06 00:20:30,753 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 00:20:31,271 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 00:20:31,272 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 00:20:31,272 - ai_service.api.routers.ai_integration_test - ERROR - Error in test_model_routing: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 00:20:31,274 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 500 Internal Server Error"
2025-03-06 00:20:31,364 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 00:20:31,368 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:20:31,369 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:20:31,373 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:20:31,373 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:20:31,373 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:20:31,374 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:20:31,374 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:20:31,374 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:20:31,380 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:20:31,381 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:20:31,381 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:20:31,381 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:20:31,381 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:20:31,382 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 00:20:31,384 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 00:20:31,384 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 00:20:31,385 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:20:31,391 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:20:31,391 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:20:31,391 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:20:31,391 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:20:31,391 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:20:31,396 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:20:31,403 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:20:31,403 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:20:31,403 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:20:31,403 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:20:31,404 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:20:31,406 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:20:31,414 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:20:31,414 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:20:31,414 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:20:31,414 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:20:31,415 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:20:31,419 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:20:31,428 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:20:31,429 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:20:31,429 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:20:31,429 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:20:31,429 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:20:31,431 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 00:20:31,432 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:20:31,438 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:20:31,439 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:20:31,439 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:20:31,439 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:20:31,439 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:20:31,444 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:20:31,452 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:20:31,453 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:20:31,453 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:20:31,453 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:20:31,453 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:20:31,461 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 00:20:31,467 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 00:20:31,475 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 00:20:32,840 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 00:20:32,841 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 00:20:32,844 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 200 OK"
2025-03-06 00:20:32,847 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 00:20:32,849 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:20:32,862 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:20:32,874 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:20:32,890 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:20:32,898 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:20:32,907 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:20:32,919 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:20:32,962 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 00:20:32,967 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 404 Not Found"
2025-03-06 00:20:32,974 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 404 Not Found"
2025-03-06 00:20:32,982 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 404 Not Found"
2025-03-06 00:20:32,989 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 00:20:33,008 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 00:23:57,347 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:23:57,353 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:23:57,353 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:23:57,353 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:23:57,353 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:23:57,353 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:23:57,354 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:23:57,359 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:23:57,361 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:23:57,361 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:23:57,361 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:23:57,361 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:23:57,362 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 00:23:57,364 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 00:23:57,364 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 00:23:57,364 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:23:57,368 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:23:57,369 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:23:57,369 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:23:57,369 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:23:57,369 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:23:57,371 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:23:57,376 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:23:57,376 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:23:57,376 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:23:57,376 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:23:57,376 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:23:57,377 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:23:57,382 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:23:57,382 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:23:57,382 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:23:57,382 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:23:57,382 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:23:57,383 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:23:57,388 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:23:57,388 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:23:57,388 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:23:57,388 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:23:57,388 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:23:57,390 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 00:23:57,391 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:23:57,396 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:23:57,396 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:23:57,396 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:23:57,397 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:23:57,397 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:23:57,399 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:23:57,408 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:23:57,408 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:23:57,408 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:23:57,408 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:23:57,408 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:28:07,076 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:28:07,087 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:28:07,087 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:28:07,088 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:28:07,088 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:28:07,088 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:28:07,092 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:28:07,101 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:28:07,105 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:28:07,105 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:28:07,106 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:28:07,106 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:28:07,109 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 00:28:07,112 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 00:28:07,112 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 00:28:07,117 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:28:07,127 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:28:07,127 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:28:07,127 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:28:07,127 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:28:07,128 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:28:07,133 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:28:07,142 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:28:07,142 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:28:07,142 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:28:07,142 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:28:07,142 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:28:07,144 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:28:07,151 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:28:07,151 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:28:07,151 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:28:07,151 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:28:07,151 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:28:07,157 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:28:07,167 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:28:07,168 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:28:07,168 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:28:07,168 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:28:07,168 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:28:07,178 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 00:28:07,187 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:28:07,209 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:28:07,210 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:28:07,210 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:28:07,210 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:28:07,211 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:28:07,218 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:28:07,229 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:28:07,229 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:28:07,230 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:28:07,230 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:28:07,230 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:28:23,945 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:33:55,239 - root - INFO - Running in local environment
2025-03-06 00:33:55,239 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 00:34:24,667 - root - INFO - Running in local environment
2025-03-06 00:34:24,667 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 00:34:26,181 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 00:34:26,186 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 00:34:26,187 - ai_service.api.routers.ai_integration_test - ERROR - Error in test_model_routing: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 00:34:26,190 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 500 Internal Server Error"
2025-03-06 00:34:26,289 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 00:34:26,294 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:34:26,296 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:34:26,301 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:34:26,301 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:34:26,301 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:34:26,301 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:34:26,301 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:34:26,302 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:34:26,307 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:34:26,309 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:34:26,309 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:34:26,309 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:34:26,310 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:34:26,311 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 00:34:26,313 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 00:34:26,313 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 00:34:26,315 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:34:26,321 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:34:26,321 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:34:26,321 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:34:26,321 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:34:26,321 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:34:26,323 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:34:26,327 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:34:26,327 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:34:26,327 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:34:26,327 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:34:26,327 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:34:26,328 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:34:26,331 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:34:26,331 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:34:26,331 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:34:26,331 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:34:26,331 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:34:26,332 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:34:26,339 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:34:26,340 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:34:26,340 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:34:26,340 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:34:26,340 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:34:26,342 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 00:34:26,343 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:34:26,346 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:34:26,347 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:34:26,347 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:34:26,347 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:34:26,347 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:34:26,349 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:34:26,353 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:34:26,353 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:34:26,353 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:34:26,353 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:34:26,353 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:34:26,356 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 00:34:26,358 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 00:34:26,361 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 00:34:27,913 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 00:34:27,915 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 00:34:27,918 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 200 OK"
2025-03-06 00:34:27,926 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 00:34:27,929 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:34:27,949 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:34:27,963 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:34:27,984 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:34:27,994 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:34:28,001 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:34:28,007 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:34:28,348 - test_containers - INFO - 
Running container stability test...
2025-03-06 00:34:28,348 - test_containers - INFO - Stability check 1/5
2025-03-06 00:34:28,579 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 00:34:28,584 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 404 Not Found"
2025-03-06 00:34:28,592 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 404 Not Found"
2025-03-06 00:34:28,596 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 404 Not Found"
2025-03-06 00:34:28,600 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 00:34:28,613 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 00:34:32,376 - test_ui_flow - INFO - Navigating to the application
2025-03-06 00:34:43,940 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 00:34:54,982 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x00000001047b42d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x00000001047ac934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x000000010430df90 cxxbridge1$string$len + 93360
3   chromedriver                        0x0000000104354de4 cxxbridge1$string$len + 383748
4   chromedriver                        0x0000000104395e80 cxxbridge1$string$len + 650144
5   chromedriver                        0x0000000104349060 cxxbridge1$string$len + 335232
6   chromedriver                        0x000000010477cc38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x000000010477ff58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x0000000104762578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x0000000104780818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x0000000104752f2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x000000010479ca60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x000000010479cbe8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x00000001047ac5a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 00:42:20,755 - root - INFO - Running in local environment
2025-03-06 00:42:20,755 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 00:42:23,447 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 00:42:23,450 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 00:42:23,451 - ai_service.api.routers.ai_integration_test - ERROR - Error in test_model_routing: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 00:42:23,455 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 500 Internal Server Error"
2025-03-06 00:42:23,488 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 00:42:23,495 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:42:23,496 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:42:23,502 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:42:23,502 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:42:23,502 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:42:23,502 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:42:23,502 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:42:23,504 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:42:23,512 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:42:23,512 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:42:23,512 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:42:23,512 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:42:23,512 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:42:23,514 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 00:42:23,520 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 00:42:23,521 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 00:42:23,522 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:42:23,528 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:42:23,528 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:42:23,528 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:42:23,528 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:42:23,528 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:42:23,531 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:42:23,535 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:42:23,535 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:42:23,535 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:42:23,535 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:42:23,535 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:42:23,536 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:42:23,543 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:42:23,543 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:42:23,543 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:42:23,543 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:42:23,543 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:42:23,544 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:42:23,548 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:42:23,548 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:42:23,548 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:42:23,548 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:42:23,548 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:42:23,550 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 00:42:23,550 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:42:23,555 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:42:23,556 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:42:23,556 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:42:23,556 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:42:23,556 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:42:23,559 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 00:42:23,563 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 00:42:23,563 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 00:42:23,563 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 00:42:23,563 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 00:42:23,563 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 00:42:23,567 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 00:42:23,570 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 00:42:23,575 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 00:42:24,876 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 00:42:24,878 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 00:42:24,882 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 200 OK"
2025-03-06 00:42:24,888 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 00:42:24,892 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:24,909 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:24,918 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:24,927 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:24,935 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:24,943 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:24,949 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:24,957 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:24,970 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:24,979 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:24,987 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:25,003 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:25,012 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:25,018 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:25,026 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:42:25,348 - test_containers - INFO - 
Running container stability test...
2025-03-06 00:42:25,349 - test_containers - INFO - Stability check 1/5
2025-03-06 00:42:25,577 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 00:42:25,579 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 404 Not Found"
2025-03-06 00:42:25,583 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 404 Not Found"
2025-03-06 00:42:25,588 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 404 Not Found"
2025-03-06 00:42:25,594 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 00:42:25,616 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 00:42:26,879 - test_ui_flow - INFO - Navigating to the application
2025-03-06 00:42:38,101 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 00:42:49,243 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x00000001027102d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x0000000102708934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x0000000102269f90 cxxbridge1$string$len + 93360
3   chromedriver                        0x00000001022b0de4 cxxbridge1$string$len + 383748
4   chromedriver                        0x00000001022f1e80 cxxbridge1$string$len + 650144
5   chromedriver                        0x00000001022a5060 cxxbridge1$string$len + 335232
6   chromedriver                        0x00000001026d8c38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x00000001026dbf58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x00000001026be578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x00000001026dc818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x00000001026aef2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x00000001026f8a60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x00000001026f8be8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x00000001027085a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 00:45:43,549 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:45:43,562 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:45:43,570 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:45:43,582 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:45:43,592 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:45:43,599 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:45:43,645 - ai_service.utils.astro_calculator - ERROR - Error in chart calculation: 'float' object has no attribute 'split'
2025-03-06 00:54:43,105 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 00:54:43,107 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 00:54:43,614 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.51s
2025-03-06 00:54:43,622 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:54:50,785 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 00:54:50,798 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=7.17s
2025-03-06 00:54:50,801 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:54:51,888 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 00:54:51,890 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=71, cost=$0.0008, time=1.09s
2025-03-06 00:54:51,892 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:54:51,896 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 00:54:51,911 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:55:07,580 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 00:55:17,548 - root - INFO - Running in local environment
2025-03-06 00:55:17,548 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 00:55:18,343 - test_containers - WARNING - Running in CPU mode
2025-03-06 00:55:18,344 - test_containers - INFO - 
Running container stability test...
2025-03-06 00:55:18,344 - test_containers - INFO - Stability check 1/5
2025-03-06 00:55:40,179 - root - INFO - Running in local environment
2025-03-06 00:55:40,179 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 00:55:40,196 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 00:55:40,198 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 404 Not Found"
2025-03-06 00:55:40,203 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 404 Not Found"
2025-03-06 00:55:40,207 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 404 Not Found"
2025-03-06 00:55:40,211 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 00:55:40,223 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 00:56:00,056 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 00:58:13,198 - root - INFO - Running in local environment
2025-03-06 00:58:13,198 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 00:58:13,218 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 404 Not Found"
2025-03-06 00:58:25,536 - root - INFO - Running in local environment
2025-03-06 00:58:25,536 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 00:58:26,275 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 404 Not Found"
2025-03-06 00:58:27,032 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 00:58:27,033 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 00:58:27,539 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.51s
2025-03-06 00:58:27,546 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 00:58:34,449 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 00:58:34,458 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=6.91s
2025-03-06 01:01:13,528 - root - INFO - Running in local environment
2025-03-06 01:01:13,528 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:01:13,560 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:01:13,565 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/672b7c54-cd7a-4418-96c2-9af0a318e6a2 "HTTP/1.1 404 Not Found"
2025-03-06 01:02:06,351 - root - INFO - Running in local environment
2025-03-06 01:02:06,351 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:02:06,382 - ai_service.api.routers.charts - INFO - Creating chart with ID: e8cb27a3-1b71-49d1-b046-06fb2236d140
2025-03-06 01:02:06,385 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: e8cb27a3-1b71-49d1-b046-06fb2236d140
2025-03-06 01:02:06,392 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:02:06,395 - ai_service.api.routers.charts - INFO - Getting chart with ID: e8cb27a3-1b71-49d1-b046-06fb2236d140
2025-03-06 01:02:06,396 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['e8cb27a3-1b71-49d1-b046-06fb2236d140']
2025-03-06 01:02:06,396 - ai_service.api.routers.charts - INFO - Chart found in global storage: e8cb27a3-1b71-49d1-b046-06fb2236d140
2025-03-06 01:02:06,399 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/e8cb27a3-1b71-49d1-b046-06fb2236d140 "HTTP/1.1 200 OK"
2025-03-06 01:03:05,767 - root - INFO - Running in local environment
2025-03-06 01:03:05,767 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:03:05,784 - ai_service.api.routers.charts - INFO - Creating chart with ID: a9713bdd-60c5-46a7-93b1-cadac9183386
2025-03-06 01:03:05,785 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID a9713bdd-60c5-46a7-93b1-cadac9183386
2025-03-06 01:03:05,785 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: a9713bdd-60c5-46a7-93b1-cadac9183386
2025-03-06 01:03:05,787 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:03:05,788 - ai_service.api.routers.charts - INFO - Getting chart with ID: a9713bdd-60c5-46a7-93b1-cadac9183386
2025-03-06 01:03:05,788 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['a9713bdd-60c5-46a7-93b1-cadac9183386']
2025-03-06 01:03:05,788 - ai_service.api.routers.charts - INFO - Chart found in global storage: a9713bdd-60c5-46a7-93b1-cadac9183386
2025-03-06 01:03:05,789 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/a9713bdd-60c5-46a7-93b1-cadac9183386 "HTTP/1.1 200 OK"
2025-03-06 01:03:05,790 - ai_service.api.routers.charts - ERROR - Error updating chart: 'a9713bdd-60c5-46a7-93b1-cadac9183386'
2025-03-06 01:03:05,791 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/a9713bdd-60c5-46a7-93b1-cadac9183386 "HTTP/1.1 500 Internal Server Error"
2025-03-06 01:03:50,235 - root - INFO - Running in local environment
2025-03-06 01:03:50,235 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:03:50,262 - ai_service.api.routers.charts - INFO - Creating chart with ID: e10b7c8a-e60a-4d92-8592-b5b784385a29
2025-03-06 01:03:50,265 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID e10b7c8a-e60a-4d92-8592-b5b784385a29
2025-03-06 01:03:50,265 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: e10b7c8a-e60a-4d92-8592-b5b784385a29
2025-03-06 01:03:50,269 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:03:50,270 - ai_service.api.routers.charts - INFO - Getting chart with ID: e10b7c8a-e60a-4d92-8592-b5b784385a29
2025-03-06 01:03:50,270 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['e10b7c8a-e60a-4d92-8592-b5b784385a29']
2025-03-06 01:03:50,270 - ai_service.api.routers.charts - INFO - Chart found in global storage: e10b7c8a-e60a-4d92-8592-b5b784385a29
2025-03-06 01:03:50,272 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/e10b7c8a-e60a-4d92-8592-b5b784385a29 "HTTP/1.1 200 OK"
2025-03-06 01:03:50,273 - ai_service.api.routers.charts - ERROR - Error updating chart: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.3/migration/
2025-03-06 01:03:50,274 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/e10b7c8a-e60a-4d92-8592-b5b784385a29 "HTTP/1.1 500 Internal Server Error"
2025-03-06 01:04:25,026 - root - INFO - Running in local environment
2025-03-06 01:04:25,026 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:04:25,045 - ai_service.api.routers.charts - INFO - Creating chart with ID: 9997675b-bacf-444b-9bac-df5cab09c00e
2025-03-06 01:04:25,046 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 9997675b-bacf-444b-9bac-df5cab09c00e
2025-03-06 01:04:25,046 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 9997675b-bacf-444b-9bac-df5cab09c00e
2025-03-06 01:04:25,048 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:04:25,049 - ai_service.api.routers.charts - INFO - Getting chart with ID: 9997675b-bacf-444b-9bac-df5cab09c00e
2025-03-06 01:04:25,049 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['9997675b-bacf-444b-9bac-df5cab09c00e']
2025-03-06 01:04:25,049 - ai_service.api.routers.charts - INFO - Chart found in global storage: 9997675b-bacf-444b-9bac-df5cab09c00e
2025-03-06 01:04:25,050 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/9997675b-bacf-444b-9bac-df5cab09c00e "HTTP/1.1 200 OK"
2025-03-06 01:04:25,051 - ai_service.api.routers.charts - INFO - Updating chart with ID: 9997675b-bacf-444b-9bac-df5cab09c00e, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:04:25,053 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/9997675b-bacf-444b-9bac-df5cab09c00e "HTTP/1.1 200 OK"
2025-03-06 01:04:25,056 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/9997675b-bacf-444b-9bac-df5cab09c00e "HTTP/1.1 200 OK"
2025-03-06 01:04:25,057 - ai_service.api.routers.charts - INFO - Getting chart with ID: 9997675b-bacf-444b-9bac-df5cab09c00e
2025-03-06 01:04:25,057 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:04:25,057 - ai_service.api.routers.charts - WARNING - Chart not found: 9997675b-bacf-444b-9bac-df5cab09c00e
2025-03-06 01:04:25,058 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/9997675b-bacf-444b-9bac-df5cab09c00e "HTTP/1.1 404 Not Found"
2025-03-06 01:08:26,358 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:10:53,701 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:11:06,637 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:11:06,639 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:11:07,145 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.51s
2025-03-06 01:11:07,150 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:11:12,475 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:11:12,489 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=5.34s
2025-03-06 01:11:12,492 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:11:13,908 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:11:13,912 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=77, cost=$0.0008, time=1.42s
2025-03-06 01:11:13,916 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:11:27,038 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:11:27,043 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:11:27,548 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 01:11:27,725 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:11:33,260 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:11:33,276 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=5.53s
2025-03-06 01:11:33,279 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:11:37,156 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:11:37,163 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=74, cost=$0.0008, time=3.88s
2025-03-06 01:11:37,167 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:11:37,171 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:11:37,188 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:11:52,821 - root - INFO - Running in local environment
2025-03-06 01:11:52,821 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:11:52,851 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:11:52,860 - ai_service.api.routers.charts - INFO - Creating chart with ID: 3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8
2025-03-06 01:11:52,864 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8
2025-03-06 01:11:52,864 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8
2025-03-06 01:11:52,867 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:11:52,868 - ai_service.api.routers.charts - INFO - Getting chart with ID: 3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8
2025-03-06 01:11:52,869 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8']
2025-03-06 01:11:52,869 - ai_service.api.routers.charts - INFO - Chart found in global storage: 3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8
2025-03-06 01:11:52,870 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8 "HTTP/1.1 200 OK"
2025-03-06 01:11:52,871 - ai_service.api.routers.charts - INFO - Updating chart with ID: 3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:11:52,874 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8 "HTTP/1.1 200 OK"
2025-03-06 01:11:52,876 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8 "HTTP/1.1 200 OK"
2025-03-06 01:11:52,877 - ai_service.api.routers.charts - INFO - Getting chart with ID: 3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8
2025-03-06 01:11:52,877 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:11:52,877 - ai_service.api.routers.charts - WARNING - Chart not found: 3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8
2025-03-06 01:11:52,878 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/3f2cea4c-b0ad-4013-b1c5-76e5711d1ba8 "HTTP/1.1 404 Not Found"
2025-03-06 01:11:52,881 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 404 Not Found"
2025-03-06 01:11:52,887 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 404 Not Found"
2025-03-06 01:11:52,894 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:11:52,913 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:12:05,699 - root - INFO - Running in local environment
2025-03-06 01:12:05,699 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:12:05,716 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:12:05,718 - ai_service.api.routers.charts - INFO - Creating chart with ID: 8f7d7461-1329-4feb-8d25-1759ba681992
2025-03-06 01:12:05,719 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 8f7d7461-1329-4feb-8d25-1759ba681992
2025-03-06 01:12:05,719 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 8f7d7461-1329-4feb-8d25-1759ba681992
2025-03-06 01:12:05,721 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:12:05,723 - ai_service.api.routers.charts - INFO - Getting chart with ID: 8f7d7461-1329-4feb-8d25-1759ba681992
2025-03-06 01:12:05,723 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['8f7d7461-1329-4feb-8d25-1759ba681992']
2025-03-06 01:12:05,724 - ai_service.api.routers.charts - INFO - Chart found in global storage: 8f7d7461-1329-4feb-8d25-1759ba681992
2025-03-06 01:12:05,725 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/8f7d7461-1329-4feb-8d25-1759ba681992 "HTTP/1.1 200 OK"
2025-03-06 01:12:05,726 - ai_service.api.routers.charts - INFO - Updating chart with ID: 8f7d7461-1329-4feb-8d25-1759ba681992, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:12:05,727 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/8f7d7461-1329-4feb-8d25-1759ba681992 "HTTP/1.1 200 OK"
2025-03-06 01:12:05,729 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/8f7d7461-1329-4feb-8d25-1759ba681992 "HTTP/1.1 200 OK"
2025-03-06 01:12:05,730 - ai_service.api.routers.charts - INFO - Getting chart with ID: 8f7d7461-1329-4feb-8d25-1759ba681992
2025-03-06 01:12:05,730 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:12:05,730 - ai_service.api.routers.charts - WARNING - Chart not found: 8f7d7461-1329-4feb-8d25-1759ba681992
2025-03-06 01:12:05,731 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/8f7d7461-1329-4feb-8d25-1759ba681992 "HTTP/1.1 404 Not Found"
2025-03-06 01:12:05,733 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 404 Not Found"
2025-03-06 01:12:05,739 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 404 Not Found"
2025-03-06 01:12:05,745 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:12:05,763 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:14:04,422 - root - INFO - Running in local environment
2025-03-06 01:14:04,422 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:14:04,446 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:14:04,449 - ai_service.api.routers.charts - INFO - Creating chart with ID: b05283f0-07b3-47d0-9db9-8f732e9d1602
2025-03-06 01:14:04,452 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID b05283f0-07b3-47d0-9db9-8f732e9d1602
2025-03-06 01:14:04,452 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: b05283f0-07b3-47d0-9db9-8f732e9d1602
2025-03-06 01:14:04,455 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:14:04,457 - ai_service.api.routers.charts - INFO - Getting chart with ID: b05283f0-07b3-47d0-9db9-8f732e9d1602
2025-03-06 01:14:04,457 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['b05283f0-07b3-47d0-9db9-8f732e9d1602']
2025-03-06 01:14:04,457 - ai_service.api.routers.charts - INFO - Chart found in global storage: b05283f0-07b3-47d0-9db9-8f732e9d1602
2025-03-06 01:14:04,459 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/b05283f0-07b3-47d0-9db9-8f732e9d1602 "HTTP/1.1 200 OK"
2025-03-06 01:14:04,460 - ai_service.api.routers.charts - INFO - Updating chart with ID: b05283f0-07b3-47d0-9db9-8f732e9d1602, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:14:04,462 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/b05283f0-07b3-47d0-9db9-8f732e9d1602 "HTTP/1.1 200 OK"
2025-03-06 01:14:04,464 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/b05283f0-07b3-47d0-9db9-8f732e9d1602 "HTTP/1.1 200 OK"
2025-03-06 01:14:04,465 - ai_service.api.routers.charts - INFO - Getting chart with ID: b05283f0-07b3-47d0-9db9-8f732e9d1602
2025-03-06 01:14:04,465 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:14:04,465 - ai_service.api.routers.charts - WARNING - Chart not found: b05283f0-07b3-47d0-9db9-8f732e9d1602
2025-03-06 01:14:04,466 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/b05283f0-07b3-47d0-9db9-8f732e9d1602 "HTTP/1.1 404 Not Found"
2025-03-06 01:14:04,474 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:14:04,478 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 404 Not Found"
2025-03-06 01:14:06,347 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:14:06,365 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:14:06,402 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:14:06,417 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:14:06,502 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:15:49,867 - root - INFO - Running in local environment
2025-03-06 01:15:49,867 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:15:49,897 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:15:49,902 - ai_service.api.routers.charts - INFO - Creating chart with ID: 08065035-fc5f-4f89-a793-fde619612ff6
2025-03-06 01:15:49,903 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 08065035-fc5f-4f89-a793-fde619612ff6
2025-03-06 01:15:49,903 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 08065035-fc5f-4f89-a793-fde619612ff6
2025-03-06 01:15:49,949 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:15:49,952 - ai_service.api.routers.charts - INFO - Getting chart with ID: 08065035-fc5f-4f89-a793-fde619612ff6
2025-03-06 01:15:49,952 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['08065035-fc5f-4f89-a793-fde619612ff6']
2025-03-06 01:15:49,952 - ai_service.api.routers.charts - INFO - Chart found in global storage: 08065035-fc5f-4f89-a793-fde619612ff6
2025-03-06 01:15:49,954 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/08065035-fc5f-4f89-a793-fde619612ff6 "HTTP/1.1 200 OK"
2025-03-06 01:15:49,956 - ai_service.api.routers.charts - INFO - Updating chart with ID: 08065035-fc5f-4f89-a793-fde619612ff6, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:15:49,958 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/08065035-fc5f-4f89-a793-fde619612ff6 "HTTP/1.1 200 OK"
2025-03-06 01:15:49,960 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/08065035-fc5f-4f89-a793-fde619612ff6 "HTTP/1.1 200 OK"
2025-03-06 01:15:49,961 - ai_service.api.routers.charts - INFO - Getting chart with ID: 08065035-fc5f-4f89-a793-fde619612ff6
2025-03-06 01:15:49,961 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:15:49,961 - ai_service.api.routers.charts - WARNING - Chart not found: 08065035-fc5f-4f89-a793-fde619612ff6
2025-03-06 01:15:49,962 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/08065035-fc5f-4f89-a793-fde619612ff6 "HTTP/1.1 404 Not Found"
2025-03-06 01:15:49,969 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:15:49,975 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:15:51,662 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:15:51,668 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:15:51,677 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:15:51,728 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:15:51,808 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:16:43,396 - root - INFO - Running in local environment
2025-03-06 01:16:43,396 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:16:43,429 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:16:43,437 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:16:43,439 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:16:43,441 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 404 Not Found"
2025-03-06 01:17:38,182 - root - INFO - Running in local environment
2025-03-06 01:17:38,182 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:17:38,222 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:17:38,229 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:17:38,237 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:17:38,241 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 503 Service Unavailable"
2025-03-06 01:18:23,963 - root - INFO - Running in local environment
2025-03-06 01:18:23,963 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:18:25,936 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:18:25,945 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:18:26,447 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 01:18:26,468 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:18:33,854 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:18:33,861 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=7.39s
2025-03-06 01:18:33,864 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:18:35,037 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:18:35,043 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=79, cost=$0.0009, time=1.17s
2025-03-06 01:18:35,052 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:18:35,071 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:18:35,089 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:18:35,090 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:18:35,097 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:18:35,097 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:18:35,097 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:18:35,097 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:18:35,097 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:18:35,098 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:18:35,104 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:18:35,104 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:18:35,104 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:18:35,104 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:18:35,104 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:18:35,106 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:18:35,108 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:18:35,108 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:18:35,109 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:18:35,113 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:18:35,113 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:18:35,114 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:18:35,114 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:18:35,114 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:18:35,121 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:18:35,125 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:18:35,125 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:18:35,125 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:18:35,126 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:18:35,126 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:18:35,127 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:18:35,132 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:18:35,132 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:18:35,132 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:18:35,133 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:18:35,133 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:18:35,135 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:18:35,143 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:18:35,144 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:18:35,144 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:18:35,144 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:18:35,144 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:18:35,146 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:18:35,147 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:18:35,153 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:18:35,153 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:18:35,153 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:18:35,153 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:18:35,153 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:18:35,159 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:18:35,163 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:18:35,163 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:18:35,163 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:18:35,164 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:18:35,164 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:18:35,169 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:18:35,171 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:18:35,174 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:18:35,176 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:18:35,177 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:18:35,180 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:18:35,530 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:18:35,531 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:18:35,531 - test_containers - INFO - Stability check 1/5
2025-03-06 01:18:35,767 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:18:35,771 - ai_service.api.routers.charts - INFO - Creating chart with ID: 17bfce18-d67f-46c4-808a-ad253c197cff
2025-03-06 01:18:35,772 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 17bfce18-d67f-46c4-808a-ad253c197cff
2025-03-06 01:18:35,772 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 17bfce18-d67f-46c4-808a-ad253c197cff
2025-03-06 01:18:35,774 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:18:35,775 - ai_service.api.routers.charts - INFO - Getting chart with ID: 17bfce18-d67f-46c4-808a-ad253c197cff
2025-03-06 01:18:35,775 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['17bfce18-d67f-46c4-808a-ad253c197cff']
2025-03-06 01:18:35,775 - ai_service.api.routers.charts - INFO - Chart found in global storage: 17bfce18-d67f-46c4-808a-ad253c197cff
2025-03-06 01:18:35,778 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/17bfce18-d67f-46c4-808a-ad253c197cff "HTTP/1.1 200 OK"
2025-03-06 01:18:35,779 - ai_service.api.routers.charts - INFO - Updating chart with ID: 17bfce18-d67f-46c4-808a-ad253c197cff, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:18:35,782 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/17bfce18-d67f-46c4-808a-ad253c197cff "HTTP/1.1 200 OK"
2025-03-06 01:18:35,785 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/17bfce18-d67f-46c4-808a-ad253c197cff "HTTP/1.1 200 OK"
2025-03-06 01:18:35,786 - ai_service.api.routers.charts - INFO - Getting chart with ID: 17bfce18-d67f-46c4-808a-ad253c197cff
2025-03-06 01:18:35,786 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:18:35,786 - ai_service.api.routers.charts - WARNING - Chart not found: 17bfce18-d67f-46c4-808a-ad253c197cff
2025-03-06 01:18:35,787 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/17bfce18-d67f-46c4-808a-ad253c197cff "HTTP/1.1 404 Not Found"
2025-03-06 01:18:35,790 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:18:35,793 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:18:35,796 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:18:35,798 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:18:35,799 - ai_service.api.routers.questionnaire - ERROR - Error processing analysis: 
2025-03-06 01:18:35,801 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 500 Internal Server Error"
2025-03-06 01:18:37,118 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:18:37,120 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:18:37,123 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:18:37,128 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:18:37,160 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:18:38,651 - test_ui_flow - INFO - Navigating to the application
2025-03-06 01:18:41,226 - root - INFO - Running in local environment
2025-03-06 01:18:41,226 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:18:41,254 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:18:41,256 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:18:41,260 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:18:41,263 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:18:41,263 - ai_service.api.routers.questionnaire - ERROR - Error processing analysis: 
2025-03-06 01:18:41,266 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 500 Internal Server Error"
2025-03-06 01:18:50,045 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 01:19:01,947 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x0000000102bbc2d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x0000000102bb4934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x0000000102715f90 cxxbridge1$string$len + 93360
3   chromedriver                        0x000000010275cde4 cxxbridge1$string$len + 383748
4   chromedriver                        0x000000010279de80 cxxbridge1$string$len + 650144
5   chromedriver                        0x0000000102751060 cxxbridge1$string$len + 335232
6   chromedriver                        0x0000000102b84c38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x0000000102b87f58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x0000000102b6a578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x0000000102b88818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x0000000102b5af2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x0000000102ba4a60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x0000000102ba4be8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x0000000102bb45a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 01:20:56,085 - root - INFO - Running in local environment
2025-03-06 01:20:56,085 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:20:56,111 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:20:56,113 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:20:56,115 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:20:56,118 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:20:56,120 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:21:46,758 - root - INFO - Running in local environment
2025-03-06 01:21:46,758 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:21:46,802 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:21:46,808 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:21:46,818 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:21:46,822 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:21:46,825 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:21:57,511 - root - INFO - Running in local environment
2025-03-06 01:21:57,511 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:21:59,429 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:21:59,430 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:21:59,936 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.51s
2025-03-06 01:21:59,946 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:22:03,423 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:22:03,433 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=3.48s
2025-03-06 01:22:03,439 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:22:04,450 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:22:04,464 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=70, cost=$0.0007, time=1.02s
2025-03-06 01:22:04,468 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:22:04,484 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:22:04,502 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:22:04,505 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:22:04,518 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:22:04,518 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:22:04,518 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:22:04,518 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:22:04,518 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:22:04,521 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:22:04,532 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:22:04,532 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:22:04,532 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:22:04,533 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:22:04,533 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:22:04,539 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:22:04,542 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:22:04,542 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:22:04,544 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:22:04,553 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:22:04,553 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:22:04,553 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:22:04,553 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:22:04,553 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:22:04,559 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:22:04,569 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:22:04,570 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:22:04,570 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:22:04,570 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:22:04,570 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:22:04,573 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:22:04,585 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:22:04,585 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:22:04,585 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:22:04,585 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:22:04,585 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:22:04,587 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:22:04,594 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:22:04,594 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:22:04,595 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:22:04,595 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:22:04,595 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:22:04,598 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:22:04,600 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:22:04,606 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:22:04,606 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:22:04,607 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:22:04,607 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:22:04,607 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:22:04,616 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:22:04,621 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:22:04,621 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:22:04,621 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:22:04,621 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:22:04,621 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:22:04,628 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:22:04,634 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:22:04,642 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:22:04,648 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:22:04,651 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:22:04,656 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:22:06,731 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:22:06,738 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:22:06,740 - test_containers - INFO - Stability check 1/5
2025-03-06 01:22:07,875 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:22:07,887 - ai_service.api.routers.charts - INFO - Creating chart with ID: 53280260-ff40-4753-a20d-7728be7b5718
2025-03-06 01:22:07,888 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 53280260-ff40-4753-a20d-7728be7b5718
2025-03-06 01:22:07,888 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 53280260-ff40-4753-a20d-7728be7b5718
2025-03-06 01:22:07,894 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:22:07,898 - ai_service.api.routers.charts - INFO - Getting chart with ID: 53280260-ff40-4753-a20d-7728be7b5718
2025-03-06 01:22:07,898 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['53280260-ff40-4753-a20d-7728be7b5718']
2025-03-06 01:22:07,899 - ai_service.api.routers.charts - INFO - Chart found in global storage: 53280260-ff40-4753-a20d-7728be7b5718
2025-03-06 01:22:07,918 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/53280260-ff40-4753-a20d-7728be7b5718 "HTTP/1.1 200 OK"
2025-03-06 01:22:07,928 - ai_service.api.routers.charts - INFO - Updating chart with ID: 53280260-ff40-4753-a20d-7728be7b5718, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:22:07,945 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/53280260-ff40-4753-a20d-7728be7b5718 "HTTP/1.1 200 OK"
2025-03-06 01:22:07,958 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/53280260-ff40-4753-a20d-7728be7b5718 "HTTP/1.1 200 OK"
2025-03-06 01:22:07,961 - ai_service.api.routers.charts - INFO - Getting chart with ID: 53280260-ff40-4753-a20d-7728be7b5718
2025-03-06 01:22:07,961 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:22:07,961 - ai_service.api.routers.charts - WARNING - Chart not found: 53280260-ff40-4753-a20d-7728be7b5718
2025-03-06 01:22:07,964 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/53280260-ff40-4753-a20d-7728be7b5718 "HTTP/1.1 404 Not Found"
2025-03-06 01:22:07,995 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:22:08,028 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:22:08,045 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:22:08,053 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:22:08,058 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:22:10,154 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:22:10,178 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:22:10,190 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:22:10,228 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:22:10,325 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:22:12,269 - test_ui_flow - INFO - Navigating to the application
2025-03-06 01:22:24,437 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 01:22:36,507 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x00000001011182d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x0000000101110934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x0000000100c71f90 cxxbridge1$string$len + 93360
3   chromedriver                        0x0000000100cb8de4 cxxbridge1$string$len + 383748
4   chromedriver                        0x0000000100cf9e80 cxxbridge1$string$len + 650144
5   chromedriver                        0x0000000100cad060 cxxbridge1$string$len + 335232
6   chromedriver                        0x00000001010e0c38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x00000001010e3f58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x00000001010c6578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x00000001010e4818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x00000001010b6f2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x0000000101100a60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x0000000101100be8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x00000001011105a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 01:22:58,538 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:23:10,754 - root - INFO - Running in local environment
2025-03-06 01:23:10,754 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:23:12,043 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:23:12,063 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:23:12,065 - test_containers - INFO - Stability check 1/5
2025-03-06 01:23:55,757 - root - INFO - Running in local environment
2025-03-06 01:23:55,758 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:23:58,219 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:23:58,226 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:23:58,818 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.59s
2025-03-06 01:23:58,883 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:24:02,217 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:24:02,230 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=3.34s
2025-03-06 01:24:02,234 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:24:05,587 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:24:05,595 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=83, cost=$0.0009, time=3.36s
2025-03-06 01:24:05,600 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:24:05,606 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:24:05,623 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:24:05,625 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:24:05,631 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:24:05,631 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:24:05,631 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:24:05,631 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:24:05,632 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:24:05,632 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:24:05,639 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:24:05,640 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:24:05,640 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:24:05,640 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:24:05,640 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:24:05,642 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:24:05,645 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:24:05,646 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:24:05,646 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:24:05,651 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:24:05,651 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:24:05,651 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:24:05,651 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:24:05,652 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:24:05,654 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:24:05,657 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:24:05,657 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:24:05,657 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:24:05,657 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:24:05,657 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:24:05,658 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:24:05,663 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:24:05,663 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:24:05,663 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:24:05,663 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:24:05,663 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:24:05,666 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:24:05,670 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:24:05,670 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:24:05,670 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:24:05,670 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:24:05,670 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:24:05,672 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:24:05,673 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:24:05,677 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:24:05,677 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:24:05,677 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:24:05,677 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:24:05,677 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:24:05,684 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:24:05,688 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:24:05,688 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:24:05,688 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:24:05,688 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:24:05,688 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:24:05,691 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:24:05,693 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:24:05,696 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:24:05,698 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:24:05,699 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:24:05,702 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:24:06,170 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:24:06,171 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:24:06,171 - test_containers - INFO - Stability check 1/5
2025-03-06 01:24:06,433 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:24:06,442 - ai_service.api.routers.charts - INFO - Creating chart with ID: 4bc499c9-9cfd-4bee-86d8-27ce9661ede7
2025-03-06 01:24:06,442 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 4bc499c9-9cfd-4bee-86d8-27ce9661ede7
2025-03-06 01:24:06,442 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 4bc499c9-9cfd-4bee-86d8-27ce9661ede7
2025-03-06 01:24:06,445 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:24:06,447 - ai_service.api.routers.charts - INFO - Getting chart with ID: 4bc499c9-9cfd-4bee-86d8-27ce9661ede7
2025-03-06 01:24:06,447 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['4bc499c9-9cfd-4bee-86d8-27ce9661ede7']
2025-03-06 01:24:06,448 - ai_service.api.routers.charts - INFO - Chart found in global storage: 4bc499c9-9cfd-4bee-86d8-27ce9661ede7
2025-03-06 01:24:06,451 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/4bc499c9-9cfd-4bee-86d8-27ce9661ede7 "HTTP/1.1 200 OK"
2025-03-06 01:24:06,458 - ai_service.api.routers.charts - INFO - Updating chart with ID: 4bc499c9-9cfd-4bee-86d8-27ce9661ede7, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:24:06,463 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/4bc499c9-9cfd-4bee-86d8-27ce9661ede7 "HTTP/1.1 200 OK"
2025-03-06 01:24:06,474 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/4bc499c9-9cfd-4bee-86d8-27ce9661ede7 "HTTP/1.1 200 OK"
2025-03-06 01:24:06,477 - ai_service.api.routers.charts - INFO - Getting chart with ID: 4bc499c9-9cfd-4bee-86d8-27ce9661ede7
2025-03-06 01:24:06,477 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:24:06,477 - ai_service.api.routers.charts - WARNING - Chart not found: 4bc499c9-9cfd-4bee-86d8-27ce9661ede7
2025-03-06 01:24:06,479 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/4bc499c9-9cfd-4bee-86d8-27ce9661ede7 "HTTP/1.1 404 Not Found"
2025-03-06 01:24:06,485 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:24:06,491 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:24:06,494 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:24:06,496 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:24:06,499 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:24:08,045 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:24:08,059 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:24:08,088 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:24:08,109 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:24:08,195 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:24:09,704 - test_ui_flow - INFO - Navigating to the application
2025-03-06 01:24:22,067 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 01:24:33,928 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x00000001014982d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x0000000101490934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x0000000100ff1f90 cxxbridge1$string$len + 93360
3   chromedriver                        0x0000000101038de4 cxxbridge1$string$len + 383748
4   chromedriver                        0x0000000101079e80 cxxbridge1$string$len + 650144
5   chromedriver                        0x000000010102d060 cxxbridge1$string$len + 335232
6   chromedriver                        0x0000000101460c38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x0000000101463f58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x0000000101446578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x0000000101464818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x0000000101436f2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x0000000101480a60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x0000000101480be8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x00000001014905a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 01:28:23,266 - root - INFO - Running in local environment
2025-03-06 01:28:23,266 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:28:24,968 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:28:24,970 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:28:25,473 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 01:28:25,483 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:28:29,702 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:28:29,710 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.22s
2025-03-06 01:28:29,716 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:28:30,554 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:28:30,559 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=72, cost=$0.0008, time=0.84s
2025-03-06 01:28:30,560 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:28:30,565 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:28:30,579 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:28:30,581 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:28:30,588 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:28:30,588 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:28:30,588 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:28:30,588 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:28:30,588 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:28:30,589 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:28:30,593 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:28:30,593 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:28:30,593 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:28:30,593 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:28:30,593 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:28:30,595 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:28:30,596 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:28:30,597 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:28:30,597 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:28:30,602 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:28:30,603 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:28:30,603 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:28:30,603 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:28:30,603 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:28:30,605 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:28:30,609 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:28:30,609 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:28:30,609 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:28:30,609 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:28:30,609 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:28:30,610 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:28:30,614 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:28:30,615 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:28:30,615 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:28:30,615 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:28:30,615 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:28:30,616 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:28:30,620 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:28:30,620 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:28:30,620 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:28:30,620 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:28:30,620 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:28:30,621 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:28:30,622 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:28:30,626 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:28:30,626 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:28:30,626 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:28:30,626 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:28:30,626 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:28:30,631 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:28:30,635 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:28:30,635 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:28:30,636 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:28:30,636 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:28:30,636 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:28:30,640 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:28:30,642 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:28:30,645 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:28:30,648 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:28:30,652 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:28:30,657 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:28:31,206 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:28:31,207 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:28:31,208 - test_containers - INFO - Stability check 1/5
2025-03-06 01:28:31,440 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:28:31,444 - ai_service.api.routers.charts - INFO - Creating chart with ID: 1a1a526b-a42b-41d3-b32c-3df0fe6d30a9
2025-03-06 01:28:31,444 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 1a1a526b-a42b-41d3-b32c-3df0fe6d30a9
2025-03-06 01:28:31,444 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 1a1a526b-a42b-41d3-b32c-3df0fe6d30a9
2025-03-06 01:28:31,445 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:28:31,447 - ai_service.api.routers.charts - INFO - Getting chart with ID: 1a1a526b-a42b-41d3-b32c-3df0fe6d30a9
2025-03-06 01:28:31,447 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['1a1a526b-a42b-41d3-b32c-3df0fe6d30a9']
2025-03-06 01:28:31,447 - ai_service.api.routers.charts - INFO - Chart found in global storage: 1a1a526b-a42b-41d3-b32c-3df0fe6d30a9
2025-03-06 01:28:31,449 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/1a1a526b-a42b-41d3-b32c-3df0fe6d30a9 "HTTP/1.1 200 OK"
2025-03-06 01:28:31,454 - ai_service.api.routers.charts - INFO - Updating chart with ID: 1a1a526b-a42b-41d3-b32c-3df0fe6d30a9, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:28:31,457 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/1a1a526b-a42b-41d3-b32c-3df0fe6d30a9 "HTTP/1.1 200 OK"
2025-03-06 01:28:31,459 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/1a1a526b-a42b-41d3-b32c-3df0fe6d30a9 "HTTP/1.1 200 OK"
2025-03-06 01:28:31,460 - ai_service.api.routers.charts - INFO - Getting chart with ID: 1a1a526b-a42b-41d3-b32c-3df0fe6d30a9
2025-03-06 01:28:31,461 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:28:31,461 - ai_service.api.routers.charts - WARNING - Chart not found: 1a1a526b-a42b-41d3-b32c-3df0fe6d30a9
2025-03-06 01:28:31,461 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/1a1a526b-a42b-41d3-b32c-3df0fe6d30a9 "HTTP/1.1 404 Not Found"
2025-03-06 01:28:31,464 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:28:31,469 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:28:31,471 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:28:31,473 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:28:31,474 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:28:33,157 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:28:33,160 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:28:33,165 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:28:33,172 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:28:33,202 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:28:34,265 - test_ui_flow - INFO - Navigating to the application
2025-03-06 01:28:46,512 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 01:28:57,593 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x00000001030cc2d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x00000001030c4934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x0000000102c25f90 cxxbridge1$string$len + 93360
3   chromedriver                        0x0000000102c6cde4 cxxbridge1$string$len + 383748
4   chromedriver                        0x0000000102cade80 cxxbridge1$string$len + 650144
5   chromedriver                        0x0000000102c61060 cxxbridge1$string$len + 335232
6   chromedriver                        0x0000000103094c38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x0000000103097f58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x000000010307a578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x0000000103098818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x000000010306af2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x00000001030b4a60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x00000001030b4be8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x00000001030c45a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 01:29:58,938 - root - INFO - Running in local environment
2025-03-06 01:29:58,938 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:30:37,034 - root - INFO - Running in local environment
2025-03-06 01:30:37,034 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:30:37,424 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:30:37,426 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:30:37,426 - test_containers - INFO - Stability check 1/5
2025-03-06 01:30:53,295 - root - INFO - Running in local environment
2025-03-06 01:30:53,295 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:30:54,554 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:29', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:32:00,013 - root - INFO - Running in local environment
2025-03-06 01:32:00,013 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:32:07,169 - root - INFO - Running in local environment
2025-03-06 01:32:07,169 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:32:07,234 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:32:07,238 - test_containers - INFO - Stability check 1/5
2025-03-06 01:32:14,727 - root - INFO - Running in local environment
2025-03-06 01:32:14,727 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:32:16,315 - test_ui_flow - INFO - Navigating to the application
2025-03-06 01:32:27,611 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 01:32:38,699 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x00000001014d42d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x00000001014cc934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x000000010102df90 cxxbridge1$string$len + 93360
3   chromedriver                        0x0000000101074de4 cxxbridge1$string$len + 383748
4   chromedriver                        0x00000001010b5e80 cxxbridge1$string$len + 650144
5   chromedriver                        0x0000000101069060 cxxbridge1$string$len + 335232
6   chromedriver                        0x000000010149cc38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x000000010149ff58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x0000000101482578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x00000001014a0818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x0000000101472f2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x00000001014bca60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x00000001014bcbe8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x00000001014cc5a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 01:32:39,786 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:31', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:32:55,109 - root - INFO - Running in local environment
2025-03-06 01:32:55,109 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:32:56,303 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:32:56,304 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:32:56,805 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 01:32:56,808 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:33:00,784 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:33:00,792 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=3.98s
2025-03-06 01:33:00,797 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:33:01,750 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:33:01,753 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=71, cost=$0.0008, time=0.95s
2025-03-06 01:33:01,755 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:33:01,758 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:33:01,767 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:33:01,768 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:33:01,773 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:33:01,773 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:33:01,773 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:33:01,773 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:33:01,773 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:33:01,774 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:33:01,778 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:33:01,778 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:33:01,778 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:33:01,778 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:33:01,778 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:33:01,780 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:33:01,782 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:33:01,782 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:33:01,783 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:33:01,787 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:33:01,787 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:33:01,787 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:33:01,787 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:33:01,787 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:33:01,789 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:33:01,793 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:33:01,793 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:33:01,793 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:33:01,793 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:33:01,793 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:33:01,794 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:33:01,799 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:33:01,799 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:33:01,799 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:33:01,800 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:33:01,800 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:33:01,800 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:33:01,804 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:33:01,805 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:33:01,805 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:33:01,805 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:33:01,805 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:33:01,809 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:33:01,810 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:33:01,814 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:33:01,815 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:33:01,815 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:33:01,815 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:33:01,815 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:33:01,819 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:33:01,823 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:33:01,823 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:33:01,823 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:33:01,823 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:33:01,823 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:33:01,827 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:33:01,829 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:33:01,832 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:33:01,835 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:33:01,837 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:33:01,840 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:33:02,209 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:33:02,209 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:33:02,210 - test_containers - INFO - Stability check 1/5
2025-03-06 01:33:02,452 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:33:02,456 - ai_service.api.routers.charts - INFO - Creating chart with ID: c93bfa00-1bc0-4f1f-adbb-92acffa2a63c
2025-03-06 01:33:02,456 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID c93bfa00-1bc0-4f1f-adbb-92acffa2a63c
2025-03-06 01:33:02,456 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: c93bfa00-1bc0-4f1f-adbb-92acffa2a63c
2025-03-06 01:33:02,458 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:33:02,459 - ai_service.api.routers.charts - INFO - Getting chart with ID: c93bfa00-1bc0-4f1f-adbb-92acffa2a63c
2025-03-06 01:33:02,459 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['c93bfa00-1bc0-4f1f-adbb-92acffa2a63c']
2025-03-06 01:33:02,459 - ai_service.api.routers.charts - INFO - Chart found in global storage: c93bfa00-1bc0-4f1f-adbb-92acffa2a63c
2025-03-06 01:33:02,461 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/c93bfa00-1bc0-4f1f-adbb-92acffa2a63c "HTTP/1.1 200 OK"
2025-03-06 01:33:02,462 - ai_service.api.routers.charts - INFO - Updating chart with ID: c93bfa00-1bc0-4f1f-adbb-92acffa2a63c, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:33:02,465 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/c93bfa00-1bc0-4f1f-adbb-92acffa2a63c "HTTP/1.1 200 OK"
2025-03-06 01:33:02,468 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/c93bfa00-1bc0-4f1f-adbb-92acffa2a63c "HTTP/1.1 200 OK"
2025-03-06 01:33:02,469 - ai_service.api.routers.charts - INFO - Getting chart with ID: c93bfa00-1bc0-4f1f-adbb-92acffa2a63c
2025-03-06 01:33:02,470 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:33:02,470 - ai_service.api.routers.charts - WARNING - Chart not found: c93bfa00-1bc0-4f1f-adbb-92acffa2a63c
2025-03-06 01:33:02,471 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/c93bfa00-1bc0-4f1f-adbb-92acffa2a63c "HTTP/1.1 404 Not Found"
2025-03-06 01:33:02,474 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:33:02,477 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:33:02,479 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:33:02,480 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:33:02,482 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:33:03,669 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:33:03,670 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:33:03,671 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:33:03,674 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:33:03,700 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:33:04,469 - test_ui_flow - INFO - Navigating to the application
2025-03-06 01:33:15,767 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 01:33:26,883 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x00000001013542d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x000000010134c934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x0000000100eadf90 cxxbridge1$string$len + 93360
3   chromedriver                        0x0000000100ef4de4 cxxbridge1$string$len + 383748
4   chromedriver                        0x0000000100f35e80 cxxbridge1$string$len + 650144
5   chromedriver                        0x0000000100ee9060 cxxbridge1$string$len + 335232
6   chromedriver                        0x000000010131cc38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x000000010131ff58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x0000000101302578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x0000000101320818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x00000001012f2f2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x000000010133ca60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x000000010133cbe8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x000000010134c5a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 01:33:27,206 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:39', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:33:53,527 - root - INFO - Running in local environment
2025-03-06 01:33:53,527 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:33:55,069 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:33:55,071 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:33:55,572 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 01:33:55,587 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:33:59,874 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:33:59,888 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.3s
2025-03-06 01:33:59,892 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:34:01,145 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:34:01,151 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=70, cost=$0.0007, time=1.26s
2025-03-06 01:34:01,158 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:34:01,166 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:34:01,178 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:34:01,179 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:34:01,188 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:34:01,188 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:34:01,189 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:34:01,189 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:34:01,189 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:34:01,190 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:34:01,196 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:34:01,196 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:34:01,196 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:34:01,196 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:34:01,196 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:34:01,199 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:34:01,203 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:34:01,204 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:34:01,205 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:34:01,209 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:34:01,209 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:34:01,209 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:34:01,209 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:34:01,209 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:34:01,212 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:34:01,216 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:34:01,216 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:34:01,216 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:34:01,216 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:34:01,217 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:34:01,218 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:34:01,222 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:34:01,222 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:34:01,222 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:34:01,222 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:34:01,222 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:34:01,223 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:34:01,227 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:34:01,227 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:34:01,227 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:34:01,227 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:34:01,227 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:34:01,230 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:34:01,232 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:34:01,237 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:34:01,237 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:34:01,237 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:34:01,237 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:34:01,237 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:34:01,244 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:34:01,250 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:34:01,251 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:34:01,251 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:34:01,251 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:34:01,251 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:34:01,255 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:34:01,257 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:34:01,262 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:34:01,271 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:34:01,274 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:34:01,283 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:34:01,942 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:34:01,944 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:34:01,945 - test_containers - INFO - Stability check 1/5
2025-03-06 01:34:02,519 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:34:02,524 - ai_service.api.routers.charts - INFO - Creating chart with ID: 4f9d7b18-e0f5-459c-8644-b8fec623b50a
2025-03-06 01:34:02,524 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 4f9d7b18-e0f5-459c-8644-b8fec623b50a
2025-03-06 01:34:02,524 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 4f9d7b18-e0f5-459c-8644-b8fec623b50a
2025-03-06 01:34:02,528 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:34:02,531 - ai_service.api.routers.charts - INFO - Getting chart with ID: 4f9d7b18-e0f5-459c-8644-b8fec623b50a
2025-03-06 01:34:02,531 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['4f9d7b18-e0f5-459c-8644-b8fec623b50a']
2025-03-06 01:34:02,531 - ai_service.api.routers.charts - INFO - Chart found in global storage: 4f9d7b18-e0f5-459c-8644-b8fec623b50a
2025-03-06 01:34:02,534 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/4f9d7b18-e0f5-459c-8644-b8fec623b50a "HTTP/1.1 200 OK"
2025-03-06 01:34:02,539 - ai_service.api.routers.charts - INFO - Updating chart with ID: 4f9d7b18-e0f5-459c-8644-b8fec623b50a, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:34:02,542 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/4f9d7b18-e0f5-459c-8644-b8fec623b50a "HTTP/1.1 200 OK"
2025-03-06 01:34:02,547 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/4f9d7b18-e0f5-459c-8644-b8fec623b50a "HTTP/1.1 200 OK"
2025-03-06 01:34:02,549 - ai_service.api.routers.charts - INFO - Getting chart with ID: 4f9d7b18-e0f5-459c-8644-b8fec623b50a
2025-03-06 01:34:02,550 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:34:02,550 - ai_service.api.routers.charts - WARNING - Chart not found: 4f9d7b18-e0f5-459c-8644-b8fec623b50a
2025-03-06 01:34:02,552 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/4f9d7b18-e0f5-459c-8644-b8fec623b50a "HTTP/1.1 404 Not Found"
2025-03-06 01:34:02,558 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:34:02,563 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:34:02,567 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:34:02,569 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:34:02,571 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:34:04,124 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:34:04,125 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:34:04,129 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:34:04,136 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:34:04,175 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:34:05,041 - test_ui_flow - INFO - Navigating to the application
2025-03-06 01:34:16,624 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 01:34:31,759 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x0000000102adc2d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x0000000102ad4934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x0000000102635f90 cxxbridge1$string$len + 93360
3   chromedriver                        0x000000010267cde4 cxxbridge1$string$len + 383748
4   chromedriver                        0x00000001026bde80 cxxbridge1$string$len + 650144
5   chromedriver                        0x0000000102671060 cxxbridge1$string$len + 335232
6   chromedriver                        0x0000000102aa4c38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x0000000102aa7f58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x0000000102a8a578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x0000000102aa8818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x0000000102a7af2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x0000000102ac4a60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x0000000102ac4be8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x0000000102ad45a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 01:34:34,091 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:32', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:43:09,632 - root - INFO - Running in local environment
2025-03-06 01:43:09,632 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:43:17,089 - root - INFO - Running in local environment
2025-03-06 01:43:17,090 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:43:31,379 - root - INFO - Running in local environment
2025-03-06 01:43:31,379 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:43:31,576 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:43:31,578 - test_containers - INFO - Stability check 1/5
2025-03-06 01:43:33,501 - root - INFO - Running in local environment
2025-03-06 01:43:33,501 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:43:35,180 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:43:35,183 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:43:35,688 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.51s
2025-03-06 01:43:35,701 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:43:39,171 - root - INFO - Running in local environment
2025-03-06 01:43:39,171 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:43:39,796 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:43:39,817 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.11s
2025-03-06 01:43:39,825 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:43:40,586 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:31', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:43:40,848 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:43:40,891 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=71, cost=$0.0008, time=1.06s
2025-03-06 01:43:40,913 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:43:40,932 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:43:40,978 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:43:40,983 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:43:40,996 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:43:40,998 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:43:40,998 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:43:40,999 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:43:40,999 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:43:41,000 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:43:41,011 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:43:41,012 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:43:41,012 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:43:41,012 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:43:41,012 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:43:41,020 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:43:41,023 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:43:41,025 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:43:41,031 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:43:41,043 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:43:41,044 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:43:41,044 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:43:41,044 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:43:41,044 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:43:41,059 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:43:41,073 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:43:41,074 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:43:41,074 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:43:41,075 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:43:41,075 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:43:41,078 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:43:41,089 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:43:41,089 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:43:41,089 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:43:41,089 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:43:41,089 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:43:41,091 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:43:41,104 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:43:41,104 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:43:41,105 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:43:41,105 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:43:41,105 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:43:41,109 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:43:41,118 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:43:41,132 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:43:41,132 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:43:41,132 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:43:41,132 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:43:41,132 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:43:41,150 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:43:41,155 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:43:41,156 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:43:41,156 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:43:41,156 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:43:41,157 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:43:41,186 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:43:41,195 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:43:41,240 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:43:41,259 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:43:41,268 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:43:41,289 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:43:42,731 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:43:42,735 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:43:42,744 - test_containers - INFO - Stability check 1/5
2025-03-06 01:43:43,173 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:43:43,178 - ai_service.api.routers.charts - INFO - Creating chart with ID: 96bd9770-58fb-4fda-ad10-e4409458554e
2025-03-06 01:43:43,180 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 96bd9770-58fb-4fda-ad10-e4409458554e
2025-03-06 01:43:43,180 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 96bd9770-58fb-4fda-ad10-e4409458554e
2025-03-06 01:43:43,186 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:43:43,194 - ai_service.api.routers.charts - INFO - Getting chart with ID: 96bd9770-58fb-4fda-ad10-e4409458554e
2025-03-06 01:43:43,194 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['96bd9770-58fb-4fda-ad10-e4409458554e']
2025-03-06 01:43:43,195 - ai_service.api.routers.charts - INFO - Chart found in global storage: 96bd9770-58fb-4fda-ad10-e4409458554e
2025-03-06 01:43:43,219 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/96bd9770-58fb-4fda-ad10-e4409458554e "HTTP/1.1 200 OK"
2025-03-06 01:43:43,251 - ai_service.api.routers.charts - INFO - Updating chart with ID: 96bd9770-58fb-4fda-ad10-e4409458554e, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:43:43,259 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/96bd9770-58fb-4fda-ad10-e4409458554e "HTTP/1.1 200 OK"
2025-03-06 01:43:43,282 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/96bd9770-58fb-4fda-ad10-e4409458554e "HTTP/1.1 200 OK"
2025-03-06 01:43:43,302 - ai_service.api.routers.charts - INFO - Getting chart with ID: 96bd9770-58fb-4fda-ad10-e4409458554e
2025-03-06 01:43:43,303 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:43:43,304 - ai_service.api.routers.charts - WARNING - Chart not found: 96bd9770-58fb-4fda-ad10-e4409458554e
2025-03-06 01:43:43,321 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/96bd9770-58fb-4fda-ad10-e4409458554e "HTTP/1.1 404 Not Found"
2025-03-06 01:43:43,370 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:43:43,422 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:43:43,437 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:43:43,445 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:43:43,449 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:43:45,730 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:43:45,744 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:43:45,777 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:43:45,871 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:43:45,982 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:43:48,528 - test_ui_flow - INFO - Navigating to the application
2025-03-06 01:43:53,241 - root - INFO - Running in local environment
2025-03-06 01:43:53,241 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:44:02,187 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 01:44:08,258 - test_ui_flow - ERROR - UI/UX flow test failed: Get started button not visible
assert False
 +  where False = <bound method WebElement.is_displayed of <selenium.webdriver.remote.webelement.WebElement (session="05dd5fa8fee2a05859b0ca1f5a076b04", element="f.7ADC44BD758F4B43213FACD0E243338A.d.CD15E014D4E790D0829C521A682DA895.e.10")>>()
 +    where <bound method WebElement.is_displayed of <selenium.webdriver.remote.webelement.WebElement (session="05dd5fa8fee2a05859b0ca1f5a076b04", element="f.7ADC44BD758F4B43213FACD0E243338A.d.CD15E014D4E790D0829C521A682DA895.e.10")>> = <selenium.webdriver.remote.webelement.WebElement (session="05dd5fa8fee2a05859b0ca1f5a076b04", element="f.7ADC44BD758F4B43213FACD0E243338A.d.CD15E014D4E790D0829C521A682DA895.e.10")>.is_displayed
2025-03-06 01:44:09,980 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:32', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:44:58,358 - root - INFO - Running in local environment
2025-03-06 01:44:58,358 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:45:03,751 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:45:03,753 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:45:04,258 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.51s
2025-03-06 01:45:04,266 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:45:10,006 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:45:10,025 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=5.76s
2025-03-06 01:45:10,029 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:45:10,822 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:45:10,827 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=55, cost=$0.0005, time=0.79s
2025-03-06 01:45:10,832 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:45:10,842 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:45:10,862 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:45:10,864 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:45:10,872 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:45:10,872 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:45:10,873 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:45:10,873 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:45:10,873 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:45:10,874 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:45:10,880 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:45:10,880 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:45:10,880 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:45:10,880 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:45:10,880 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:45:10,883 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:45:10,884 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:45:10,884 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:45:10,885 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:45:10,889 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:45:10,889 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:45:10,890 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:45:10,890 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:45:10,890 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:45:10,893 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:45:10,898 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:45:10,898 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:45:10,898 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:45:10,898 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:45:10,898 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:45:10,899 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:45:10,905 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:45:10,905 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:45:10,905 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:45:10,905 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:45:10,905 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:45:10,906 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:45:10,910 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:45:10,911 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:45:10,911 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:45:10,911 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:45:10,911 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:45:10,912 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:45:10,913 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:45:10,917 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:45:10,917 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:45:10,917 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:45:10,917 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:45:10,917 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:45:10,920 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:45:10,923 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:45:10,923 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:45:10,924 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:45:10,924 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:45:10,924 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:45:10,928 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:45:10,931 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:45:10,935 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:45:10,937 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:45:10,938 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:45:10,942 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:45:11,434 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:45:11,436 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:45:11,438 - test_containers - INFO - Stability check 1/5
2025-03-06 01:45:11,777 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:45:11,783 - ai_service.api.routers.charts - INFO - Creating chart with ID: 4a605292-4d4f-46cf-a8ee-cac7daa854aa
2025-03-06 01:45:11,783 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 4a605292-4d4f-46cf-a8ee-cac7daa854aa
2025-03-06 01:45:11,783 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 4a605292-4d4f-46cf-a8ee-cac7daa854aa
2025-03-06 01:45:11,790 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:45:11,793 - ai_service.api.routers.charts - INFO - Getting chart with ID: 4a605292-4d4f-46cf-a8ee-cac7daa854aa
2025-03-06 01:45:11,793 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['4a605292-4d4f-46cf-a8ee-cac7daa854aa']
2025-03-06 01:45:11,793 - ai_service.api.routers.charts - INFO - Chart found in global storage: 4a605292-4d4f-46cf-a8ee-cac7daa854aa
2025-03-06 01:45:11,808 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/4a605292-4d4f-46cf-a8ee-cac7daa854aa "HTTP/1.1 200 OK"
2025-03-06 01:45:11,817 - ai_service.api.routers.charts - INFO - Updating chart with ID: 4a605292-4d4f-46cf-a8ee-cac7daa854aa, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:45:11,822 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/4a605292-4d4f-46cf-a8ee-cac7daa854aa "HTTP/1.1 200 OK"
2025-03-06 01:45:11,841 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/4a605292-4d4f-46cf-a8ee-cac7daa854aa "HTTP/1.1 200 OK"
2025-03-06 01:45:11,843 - ai_service.api.routers.charts - INFO - Getting chart with ID: 4a605292-4d4f-46cf-a8ee-cac7daa854aa
2025-03-06 01:45:11,844 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:45:11,844 - ai_service.api.routers.charts - WARNING - Chart not found: 4a605292-4d4f-46cf-a8ee-cac7daa854aa
2025-03-06 01:45:11,849 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/4a605292-4d4f-46cf-a8ee-cac7daa854aa "HTTP/1.1 404 Not Found"
2025-03-06 01:45:11,867 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:45:11,881 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:45:11,894 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:45:11,903 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:45:11,911 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:45:13,530 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:45:13,564 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:45:13,600 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:45:13,625 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:45:13,690 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:45:15,585 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 01:45:40,298 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x0000000102c3c2d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x0000000102c34934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x0000000102795f90 cxxbridge1$string$len + 93360
3   chromedriver                        0x00000001027dcde4 cxxbridge1$string$len + 383748
4   chromedriver                        0x000000010281de80 cxxbridge1$string$len + 650144
5   chromedriver                        0x00000001027d1060 cxxbridge1$string$len + 335232
6   chromedriver                        0x0000000102c04c38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x0000000102c07f58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x0000000102bea578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x0000000102c08818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x0000000102bdaf2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x0000000102c24a60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x0000000102c24be8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x0000000102c345a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 01:45:41,968 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:44', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:46:33,898 - root - INFO - Running in local environment
2025-03-06 01:46:33,898 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:46:38,377 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:46:38,379 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:46:38,880 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 01:46:38,888 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:46:43,289 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:46:43,299 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.41s
2025-03-06 01:46:43,303 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:46:46,878 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:46:46,886 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=72, cost=$0.0008, time=3.58s
2025-03-06 01:46:46,890 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:46:46,895 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:46:46,914 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:46:46,916 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:46:46,921 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:46:46,921 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:46:46,922 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:46:46,922 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:46:46,922 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:46:46,923 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:46:46,927 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:46:46,927 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:46:46,927 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:46:46,927 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:46:46,927 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:46:46,929 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:46:46,931 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:46:46,931 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:46:46,932 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:46:46,936 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:46:46,936 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:46:46,936 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:46:46,936 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:46:46,936 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:46:46,943 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:46:46,948 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:46:46,948 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:46:46,948 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:46:46,948 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:46:46,948 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:46:46,949 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:46:46,954 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:46:46,955 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:46:46,955 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:46:46,955 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:46:46,955 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:46:46,956 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:46:46,960 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:46:46,960 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:46:46,960 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:46:46,960 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:46:46,960 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:46:46,961 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:46:46,962 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:46:46,966 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:46:46,966 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:46:46,967 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:46:46,967 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:46:46,967 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:46:46,969 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:46:46,972 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:46:46,973 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:46:46,973 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:46:46,973 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:46:46,973 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:46:46,976 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:46:46,978 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:46:46,982 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:46:46,984 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:46:46,986 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:46:46,990 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:46:47,358 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:46:47,360 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:46:47,360 - test_containers - INFO - Stability check 1/5
2025-03-06 01:46:47,608 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:46:47,610 - ai_service.api.routers.charts - INFO - Creating chart with ID: b92cb399-5c3e-43e1-aaa4-5fc83867ff86
2025-03-06 01:46:47,611 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID b92cb399-5c3e-43e1-aaa4-5fc83867ff86
2025-03-06 01:46:47,611 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: b92cb399-5c3e-43e1-aaa4-5fc83867ff86
2025-03-06 01:46:47,613 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:46:47,614 - ai_service.api.routers.charts - INFO - Getting chart with ID: b92cb399-5c3e-43e1-aaa4-5fc83867ff86
2025-03-06 01:46:47,614 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['b92cb399-5c3e-43e1-aaa4-5fc83867ff86']
2025-03-06 01:46:47,614 - ai_service.api.routers.charts - INFO - Chart found in global storage: b92cb399-5c3e-43e1-aaa4-5fc83867ff86
2025-03-06 01:46:47,616 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/b92cb399-5c3e-43e1-aaa4-5fc83867ff86 "HTTP/1.1 200 OK"
2025-03-06 01:46:47,619 - ai_service.api.routers.charts - INFO - Updating chart with ID: b92cb399-5c3e-43e1-aaa4-5fc83867ff86, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:46:47,621 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/b92cb399-5c3e-43e1-aaa4-5fc83867ff86 "HTTP/1.1 200 OK"
2025-03-06 01:46:47,623 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/b92cb399-5c3e-43e1-aaa4-5fc83867ff86 "HTTP/1.1 200 OK"
2025-03-06 01:46:47,624 - ai_service.api.routers.charts - INFO - Getting chart with ID: b92cb399-5c3e-43e1-aaa4-5fc83867ff86
2025-03-06 01:46:47,624 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:46:47,624 - ai_service.api.routers.charts - WARNING - Chart not found: b92cb399-5c3e-43e1-aaa4-5fc83867ff86
2025-03-06 01:46:47,625 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/b92cb399-5c3e-43e1-aaa4-5fc83867ff86 "HTTP/1.1 404 Not Found"
2025-03-06 01:46:47,630 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:46:47,634 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:46:47,638 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:46:47,639 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:46:47,640 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:46:50,676 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:46:50,690 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:46:50,709 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:46:50,727 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:46:50,802 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:46:51,031 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:28', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:47:12,581 - root - INFO - Running in local environment
2025-03-06 01:47:12,582 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:47:16,777 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:47:16,782 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:47:17,285 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 01:47:17,292 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:47:21,692 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:47:21,726 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.43s
2025-03-06 01:47:21,745 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:47:22,817 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:47:22,832 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=63, cost=$0.0006, time=1.08s
2025-03-06 01:47:22,839 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:47:22,845 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:47:22,862 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:47:22,864 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:47:22,874 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:47:22,874 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:47:22,874 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:47:22,874 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:47:22,874 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:47:22,875 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:47:22,881 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:47:22,881 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:47:22,881 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:47:22,881 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:47:22,881 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:47:22,883 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:47:22,884 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:47:22,885 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:47:22,886 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:47:22,891 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:47:22,892 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:47:22,892 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:47:22,892 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:47:22,892 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:47:22,895 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:47:22,900 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:47:22,900 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:47:22,900 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:47:22,900 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:47:22,900 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:47:22,902 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:47:22,909 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:47:22,909 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:47:22,909 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:47:22,909 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:47:22,909 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:47:22,910 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:47:22,920 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:47:22,921 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:47:22,921 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:47:22,921 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:47:22,921 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:47:22,927 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:47:22,929 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:47:22,936 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:47:22,936 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:47:22,936 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:47:22,936 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:47:22,936 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:47:22,941 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:47:22,945 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:47:22,945 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:47:22,946 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:47:22,946 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:47:22,946 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:47:22,955 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:47:22,958 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:47:22,966 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:47:22,970 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:47:22,972 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:47:22,975 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:47:23,359 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:47:23,360 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:47:23,361 - test_containers - INFO - Stability check 1/5
2025-03-06 01:47:23,624 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:47:23,631 - ai_service.api.routers.charts - INFO - Creating chart with ID: 98f748b4-d2fc-44e6-8277-3687ec9f7122
2025-03-06 01:47:23,632 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 98f748b4-d2fc-44e6-8277-3687ec9f7122
2025-03-06 01:47:23,632 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 98f748b4-d2fc-44e6-8277-3687ec9f7122
2025-03-06 01:47:23,635 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:47:23,639 - ai_service.api.routers.charts - INFO - Getting chart with ID: 98f748b4-d2fc-44e6-8277-3687ec9f7122
2025-03-06 01:47:23,640 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['98f748b4-d2fc-44e6-8277-3687ec9f7122']
2025-03-06 01:47:23,640 - ai_service.api.routers.charts - INFO - Chart found in global storage: 98f748b4-d2fc-44e6-8277-3687ec9f7122
2025-03-06 01:47:23,645 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/98f748b4-d2fc-44e6-8277-3687ec9f7122 "HTTP/1.1 200 OK"
2025-03-06 01:47:23,650 - ai_service.api.routers.charts - INFO - Updating chart with ID: 98f748b4-d2fc-44e6-8277-3687ec9f7122, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:47:23,654 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/98f748b4-d2fc-44e6-8277-3687ec9f7122 "HTTP/1.1 200 OK"
2025-03-06 01:47:23,665 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/98f748b4-d2fc-44e6-8277-3687ec9f7122 "HTTP/1.1 200 OK"
2025-03-06 01:47:23,667 - ai_service.api.routers.charts - INFO - Getting chart with ID: 98f748b4-d2fc-44e6-8277-3687ec9f7122
2025-03-06 01:47:23,667 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:47:23,668 - ai_service.api.routers.charts - WARNING - Chart not found: 98f748b4-d2fc-44e6-8277-3687ec9f7122
2025-03-06 01:47:23,671 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/98f748b4-d2fc-44e6-8277-3687ec9f7122 "HTTP/1.1 404 Not Found"
2025-03-06 01:47:23,681 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:47:23,685 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:47:23,688 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:47:23,690 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:47:23,692 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:47:25,349 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:47:25,494 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:47:25,513 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:47:25,613 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:47:25,750 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:47:27,881 - test_ui_flow - INFO - Navigating to the application
2025-03-06 01:47:30,720 - test_ui_flow - INFO - Filling in the birth details form
2025-03-06 01:47:31,445 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:24', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:48:48,932 - root - INFO - Running in local environment
2025-03-06 01:48:48,932 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:48:50,442 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 01:48:50,443 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 01:48:50,949 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.51s
2025-03-06 01:48:50,955 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:48:55,498 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:48:55,507 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.55s
2025-03-06 01:48:55,511 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:48:56,614 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 01:48:56,617 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=70, cost=$0.0007, time=1.1s
2025-03-06 01:48:56,618 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:48:56,625 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 01:48:56,643 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 01:48:56,644 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:48:56,649 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:48:56,650 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:48:56,650 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:48:56,650 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:48:56,650 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:48:56,652 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:48:56,657 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:48:56,657 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:48:56,657 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:48:56,657 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:48:56,657 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:48:56,661 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 01:48:56,666 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 01:48:56,666 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 01:48:56,667 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:48:56,673 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:48:56,673 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:48:56,673 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:48:56,673 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:48:56,673 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:48:56,675 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:48:56,680 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:48:56,680 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:48:56,680 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:48:56,680 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:48:56,680 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:48:56,681 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:48:56,687 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:48:56,687 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:48:56,687 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:48:56,687 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:48:56,688 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:48:56,690 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:48:56,695 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:48:56,695 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:48:56,696 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:48:56,696 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:48:56,696 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:48:56,698 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 01:48:56,699 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:48:56,704 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:48:56,704 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:48:56,704 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:48:56,704 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:48:56,704 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:48:56,706 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 01:48:56,710 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 01:48:56,710 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 01:48:56,710 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 01:48:56,710 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 01:48:56,710 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 01:48:56,714 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:48:56,717 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 01:48:56,721 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 01:48:56,724 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:48:56,725 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 01:48:56,729 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 01:48:57,160 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:48:57,161 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:48:57,164 - test_containers - INFO - Stability check 1/5
2025-03-06 01:48:57,435 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 01:48:57,437 - ai_service.api.routers.charts - INFO - Creating chart with ID: cb0028fe-9c91-43c0-81bd-01b1dc978c8f
2025-03-06 01:48:57,437 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID cb0028fe-9c91-43c0-81bd-01b1dc978c8f
2025-03-06 01:48:57,437 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: cb0028fe-9c91-43c0-81bd-01b1dc978c8f
2025-03-06 01:48:57,438 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 01:48:57,440 - ai_service.api.routers.charts - INFO - Getting chart with ID: cb0028fe-9c91-43c0-81bd-01b1dc978c8f
2025-03-06 01:48:57,440 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['cb0028fe-9c91-43c0-81bd-01b1dc978c8f']
2025-03-06 01:48:57,440 - ai_service.api.routers.charts - INFO - Chart found in global storage: cb0028fe-9c91-43c0-81bd-01b1dc978c8f
2025-03-06 01:48:57,441 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/cb0028fe-9c91-43c0-81bd-01b1dc978c8f "HTTP/1.1 200 OK"
2025-03-06 01:48:57,442 - ai_service.api.routers.charts - INFO - Updating chart with ID: cb0028fe-9c91-43c0-81bd-01b1dc978c8f, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 01:48:57,443 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/cb0028fe-9c91-43c0-81bd-01b1dc978c8f "HTTP/1.1 200 OK"
2025-03-06 01:48:57,444 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/cb0028fe-9c91-43c0-81bd-01b1dc978c8f "HTTP/1.1 200 OK"
2025-03-06 01:48:57,446 - ai_service.api.routers.charts - INFO - Getting chart with ID: cb0028fe-9c91-43c0-81bd-01b1dc978c8f
2025-03-06 01:48:57,447 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 01:48:57,447 - ai_service.api.routers.charts - WARNING - Chart not found: cb0028fe-9c91-43c0-81bd-01b1dc978c8f
2025-03-06 01:48:57,448 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/cb0028fe-9c91-43c0-81bd-01b1dc978c8f "HTTP/1.1 404 Not Found"
2025-03-06 01:48:57,450 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 01:48:57,452 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:48:57,455 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 01:48:57,456 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 01:48:57,457 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 01:48:59,111 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 01:48:59,124 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 01:48:59,219 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 01:48:59,232 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 01:48:59,296 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 01:49:01,194 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:22', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:53:13,686 - root - INFO - Running in local environment
2025-03-06 01:53:13,686 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:53:13,925 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:16', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 01:53:20,848 - root - INFO - Running in local environment
2025-03-06 01:53:20,848 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 01:53:21,282 - test_containers - WARNING - Running in CPU mode
2025-03-06 01:53:21,283 - test_containers - INFO - 
Running container stability test...
2025-03-06 01:53:21,284 - test_containers - INFO - Stability check 1/5
2025-03-06 02:01:15,110 - root - INFO - Running in local environment
2025-03-06 02:01:15,110 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:01:23,929 - root - INFO - Running in local environment
2025-03-06 02:01:23,929 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:01:24,376 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:36', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 02:01:33,878 - root - INFO - Running in local environment
2025-03-06 02:01:33,878 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:01:33,960 - test_containers - INFO - 
Running container stability test...
2025-03-06 02:01:33,961 - test_containers - INFO - Stability check 1/5
2025-03-06 02:01:40,849 - root - INFO - Running in local environment
2025-03-06 02:01:40,850 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:01:41,331 - test_containers - WARNING - Running in CPU mode
2025-03-06 02:01:41,332 - test_containers - INFO - 
Running container stability test...
2025-03-06 02:01:41,333 - test_containers - INFO - Stability check 1/5
2025-03-06 02:01:41,592 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:45', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 02:09:19,370 - root - INFO - Running in local environment
2025-03-06 02:09:19,370 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:09:19,595 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:39', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 02:09:25,760 - root - INFO - Running in local environment
2025-03-06 02:09:25,760 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:09:27,281 - test_ui_flow - INFO - Navigating to the application
2025-03-06 02:09:29,440 - test_ui_flow - INFO - Filling in the birth details form
2025-03-06 02:12:40,823 - root - INFO - Running in local environment
2025-03-06 02:12:40,823 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:12:42,241 - test_ui_flow - INFO - Navigating to the application
2025-03-06 02:12:50,064 - test_ui_flow - INFO - Filling in the birth details form
2025-03-06 02:13:29,062 - root - INFO - Running in local environment
2025-03-06 02:13:29,062 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:13:29,584 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:41', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 02:14:07,987 - root - INFO - Running in local environment
2025-03-06 02:14:07,987 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:14:08,136 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:31', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 02:14:15,945 - root - INFO - Running in local environment
2025-03-06 02:14:15,945 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:14:16,697 - test_ui_flow - INFO - Navigating to the application
2025-03-06 02:14:19,008 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 02:14:42,213 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x00000001052102d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x0000000105208934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x0000000104d69f90 cxxbridge1$string$len + 93360
3   chromedriver                        0x0000000104db0de4 cxxbridge1$string$len + 383748
4   chromedriver                        0x0000000104df1e80 cxxbridge1$string$len + 650144
5   chromedriver                        0x0000000104da5060 cxxbridge1$string$len + 335232
6   chromedriver                        0x00000001051d8c38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x00000001051dbf58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x00000001051be578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x00000001051dc818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x00000001051aef2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x00000001051f8a60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x00000001051f8be8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x00000001052085a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 02:14:42,311 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:33', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 02:18:47,099 - root - INFO - Running in local environment
2025-03-06 02:18:47,099 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:18:48,081 - test_ui_flow - INFO - Navigating to the application
2025-03-06 02:18:52,008 - test_ui_flow - INFO - Filling in the birth details form
2025-03-06 02:19:48,183 - root - INFO - Running in local environment
2025-03-06 02:19:48,183 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:19:48,913 - test_ui_flow - INFO - Starting complete UI/UX flow test
2025-03-06 02:20:12,891 - test_ui_flow - ERROR - UI/UX flow test failed: Message: 
Stacktrace:
0   chromedriver                        0x0000000102ba42d4 cxxbridge1$str$ptr + 2739836
1   chromedriver                        0x0000000102b9c934 cxxbridge1$str$ptr + 2708700
2   chromedriver                        0x00000001026fdf90 cxxbridge1$string$len + 93360
3   chromedriver                        0x0000000102744de4 cxxbridge1$string$len + 383748
4   chromedriver                        0x0000000102785e80 cxxbridge1$string$len + 650144
5   chromedriver                        0x0000000102739060 cxxbridge1$string$len + 335232
6   chromedriver                        0x0000000102b6cc38 cxxbridge1$str$ptr + 2512864
7   chromedriver                        0x0000000102b6ff58 cxxbridge1$str$ptr + 2525952
8   chromedriver                        0x0000000102b52578 cxxbridge1$str$ptr + 2404640
9   chromedriver                        0x0000000102b70818 cxxbridge1$str$ptr + 2528192
10  chromedriver                        0x0000000102b42f2c cxxbridge1$str$ptr + 2341588
11  chromedriver                        0x0000000102b8ca60 cxxbridge1$str$ptr + 2643464
12  chromedriver                        0x0000000102b8cbe8 cxxbridge1$str$ptr + 2643856
13  chromedriver                        0x0000000102b9c5a8 cxxbridge1$str$ptr + 2707792
14  libsystem_pthread.dylib             0x0000000188bb42e4 _pthread_start + 136
15  libsystem_pthread.dylib             0x0000000188baf0fc thread_start + 8

2025-03-06 02:20:20,640 - root - INFO - Running in local environment
2025-03-06 02:20:20,640 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:20:21,637 - test_ui_flow - INFO - Navigating to the application
2025-03-06 02:20:48,926 - root - INFO - Running in local environment
2025-03-06 02:20:48,926 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:20:49,619 - test_ui_flow - INFO - Navigating to the application
2025-03-06 02:20:50,980 - test_ui_flow - INFO - Filling in the birth details form
2025-03-06 02:21:56,556 - root - INFO - Running in local environment
2025-03-06 02:21:56,556 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:21:57,236 - test_ui_flow - INFO - Navigating to the application
2025-03-06 02:21:58,618 - test_ui_flow - INFO - Filling in the birth details form
2025-03-06 02:22:13,632 - root - INFO - Running in local environment
2025-03-06 02:22:13,632 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:22:14,563 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:34', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 02:22:55,387 - root - INFO - Running in local environment
2025-03-06 02:22:55,387 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:22:55,625 - test_ui_flow - INFO - API Response: {'originalTime': '14:30', 'suggestedTime': '14:36', 'confidence': 85, 'reliability': 'high', 'taskPredictions': {'time': 85, 'ascendant': 90, 'houses': 80}, 'explanation': 'Test rectification based on provided data'}
2025-03-06 02:23:02,130 - root - INFO - Running in local environment
2025-03-06 02:23:02,130 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 02:37:43,517 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 02:37:43,519 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 02:37:43,526 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 02:37:43,529 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 02:37:43,532 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 02:37:43,538 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 05:49:56,677 - root - INFO - Running in local environment
2025-03-06 05:49:56,677 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 05:49:58,602 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 05:49:58,605 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 05:49:59,108 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 05:49:59,113 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 05:50:02,320 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 05:50:02,328 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=3.21s
2025-03-06 05:50:02,330 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 05:50:03,420 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 05:50:03,428 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=69, cost=$0.0007, time=1.1s
2025-03-06 05:50:03,433 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 05:50:03,439 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 05:50:03,450 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 05:50:03,451 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:03,459 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:03,459 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:03,460 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:03,460 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:03,460 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:03,461 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:03,467 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:03,467 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:03,467 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:03,467 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:03,467 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:03,469 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 05:50:03,471 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 05:50:03,471 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 05:50:03,472 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:03,476 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:03,476 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:03,476 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:03,476 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:03,476 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:03,478 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:03,482 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:03,482 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:03,483 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:03,483 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:03,483 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:03,484 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:03,490 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:03,490 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:03,490 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:03,490 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:03,490 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:03,491 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:03,496 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:03,496 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:03,496 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:03,496 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:03,496 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:03,501 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 05:50:03,502 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:03,506 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:03,506 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:03,506 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:03,506 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:03,506 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:03,509 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:03,523 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:03,525 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:03,525 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:03,525 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:03,525 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:03,560 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 05:50:03,567 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 05:50:03,587 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 05:50:03,592 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 05:50:03,595 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 05:50:03,612 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 05:50:03,655 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 05:50:03,656 - ai_service.api.routers.charts - INFO - Creating chart with ID: 5fbea9e5-7dbe-49fd-8e09-744e159fc859
2025-03-06 05:50:03,657 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 5fbea9e5-7dbe-49fd-8e09-744e159fc859
2025-03-06 05:50:03,657 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 5fbea9e5-7dbe-49fd-8e09-744e159fc859
2025-03-06 05:50:03,658 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 05:50:03,659 - ai_service.api.routers.charts - INFO - Getting chart with ID: 5fbea9e5-7dbe-49fd-8e09-744e159fc859
2025-03-06 05:50:03,659 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['5fbea9e5-7dbe-49fd-8e09-744e159fc859']
2025-03-06 05:50:03,659 - ai_service.api.routers.charts - INFO - Chart found in global storage: 5fbea9e5-7dbe-49fd-8e09-744e159fc859
2025-03-06 05:50:03,660 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/5fbea9e5-7dbe-49fd-8e09-744e159fc859 "HTTP/1.1 200 OK"
2025-03-06 05:50:03,661 - ai_service.api.routers.charts - INFO - Updating chart with ID: 5fbea9e5-7dbe-49fd-8e09-744e159fc859, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 05:50:03,662 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/5fbea9e5-7dbe-49fd-8e09-744e159fc859 "HTTP/1.1 200 OK"
2025-03-06 05:50:03,664 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/5fbea9e5-7dbe-49fd-8e09-744e159fc859 "HTTP/1.1 200 OK"
2025-03-06 05:50:03,665 - ai_service.api.routers.charts - INFO - Getting chart with ID: 5fbea9e5-7dbe-49fd-8e09-744e159fc859
2025-03-06 05:50:03,665 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 05:50:03,665 - ai_service.api.routers.charts - WARNING - Chart not found: 5fbea9e5-7dbe-49fd-8e09-744e159fc859
2025-03-06 05:50:03,666 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/5fbea9e5-7dbe-49fd-8e09-744e159fc859 "HTTP/1.1 404 Not Found"
2025-03-06 05:50:03,669 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 05:50:03,671 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 05:50:03,672 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 05:50:03,673 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 05:50:03,674 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 05:50:04,944 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 05:50:04,946 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 05:50:04,954 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 05:50:04,963 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 05:50:04,993 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 05:50:27,577 - root - INFO - Running in local environment
2025-03-06 05:50:27,577 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 05:50:28,706 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 05:50:28,709 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 05:50:29,214 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 05:50:29,223 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 05:50:33,771 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 05:50:33,786 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.56s
2025-03-06 05:50:33,795 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 05:50:34,736 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 05:50:34,742 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=66, cost=$0.0007, time=0.94s
2025-03-06 05:50:34,747 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 05:50:34,759 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 05:50:34,771 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 05:50:34,772 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:34,779 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:34,779 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:34,779 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:34,779 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:34,780 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:34,780 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:34,785 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:34,785 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:34,785 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:34,785 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:34,786 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:34,788 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 05:50:34,789 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 05:50:34,790 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 05:50:34,791 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:34,796 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:34,796 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:34,796 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:34,796 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:34,796 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:34,799 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:34,803 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:34,803 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:34,803 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:34,803 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:34,803 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:34,804 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:34,809 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:34,809 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:34,809 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:34,809 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:34,809 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:34,810 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:34,814 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:34,814 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:34,814 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:34,814 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:34,814 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:34,815 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 05:50:34,816 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:34,819 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:34,820 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:34,820 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:34,820 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:34,820 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:34,826 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 05:50:34,829 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 05:50:34,829 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 05:50:34,829 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 05:50:34,829 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 05:50:34,829 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 05:50:34,832 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 05:50:34,834 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 05:50:34,838 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 200 OK"
2025-03-06 05:50:34,840 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 05:50:34,842 - httpx - INFO - HTTP Request: GET http://testserver/api/geocode?query=New+York "HTTP/1.1 404 Not Found"
2025-03-06 05:50:34,844 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 05:50:34,863 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 05:50:34,864 - ai_service.api.routers.charts - INFO - Creating chart with ID: b6f1c008-0e6b-45a4-a81f-8a4bff46bea7
2025-03-06 05:50:34,864 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID b6f1c008-0e6b-45a4-a81f-8a4bff46bea7
2025-03-06 05:50:34,864 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: b6f1c008-0e6b-45a4-a81f-8a4bff46bea7
2025-03-06 05:50:34,865 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 05:50:34,866 - ai_service.api.routers.charts - INFO - Getting chart with ID: b6f1c008-0e6b-45a4-a81f-8a4bff46bea7
2025-03-06 05:50:34,866 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['b6f1c008-0e6b-45a4-a81f-8a4bff46bea7']
2025-03-06 05:50:34,866 - ai_service.api.routers.charts - INFO - Chart found in global storage: b6f1c008-0e6b-45a4-a81f-8a4bff46bea7
2025-03-06 05:50:34,867 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/b6f1c008-0e6b-45a4-a81f-8a4bff46bea7 "HTTP/1.1 200 OK"
2025-03-06 05:50:34,868 - ai_service.api.routers.charts - INFO - Updating chart with ID: b6f1c008-0e6b-45a4-a81f-8a4bff46bea7, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 05:50:34,869 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/b6f1c008-0e6b-45a4-a81f-8a4bff46bea7 "HTTP/1.1 200 OK"
2025-03-06 05:50:34,870 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/b6f1c008-0e6b-45a4-a81f-8a4bff46bea7 "HTTP/1.1 200 OK"
2025-03-06 05:50:34,871 - ai_service.api.routers.charts - INFO - Getting chart with ID: b6f1c008-0e6b-45a4-a81f-8a4bff46bea7
2025-03-06 05:50:34,871 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 05:50:34,871 - ai_service.api.routers.charts - WARNING - Chart not found: b6f1c008-0e6b-45a4-a81f-8a4bff46bea7
2025-03-06 05:50:34,872 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/b6f1c008-0e6b-45a4-a81f-8a4bff46bea7 "HTTP/1.1 404 Not Found"
2025-03-06 05:50:34,875 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 05:50:34,877 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 05:50:34,878 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 05:50:34,879 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 05:50:34,879 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 05:50:36,267 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 05:50:36,268 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 05:50:36,270 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 05:50:36,274 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 05:50:36,300 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 06:36:23,234 - root - INFO - Running in local environment
2025-03-06 06:36:23,234 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 06:38:51,926 - root - INFO - Running in local environment
2025-03-06 06:38:51,926 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 06:40:45,623 - root - INFO - Running in local environment
2025-03-06 06:40:45,623 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 06:40:46,796 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 06:40:46,799 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 06:40:47,303 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 06:40:47,318 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:40:52,052 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 06:40:52,062 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.74s
2025-03-06 06:40:52,067 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:40:53,074 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 06:40:53,078 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=68, cost=$0.0007, time=1.01s
2025-03-06 06:40:53,081 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:40:53,090 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 06:40:53,099 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:40:53,100 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:40:53,105 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:40:53,105 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:40:53,105 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:40:53,105 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:40:53,105 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:40:53,106 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:40:53,109 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:40:53,110 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:40:53,110 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:40:53,110 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:40:53,110 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:40:53,112 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 06:40:53,113 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 06:40:53,113 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 06:40:53,115 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:40:53,119 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:40:53,119 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:40:53,120 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:40:53,120 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:40:53,120 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:40:53,123 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:40:53,127 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:40:53,127 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:40:53,127 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:40:53,127 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:40:53,127 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:40:53,128 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:40:53,132 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:40:53,132 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:40:53,132 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:40:53,133 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:40:53,133 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:40:53,133 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:40:53,137 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:40:53,137 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:40:53,137 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:40:53,138 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:40:53,138 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:40:53,142 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 06:40:53,142 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:40:53,146 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:40:53,146 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:40:53,146 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:40:53,146 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:40:53,146 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:40:53,148 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:40:53,152 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:40:53,152 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:40:53,152 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:40:53,152 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:40:53,152 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:40:53,156 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 06:40:53,157 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 06:40:53,160 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate "HTTP/1.1 422 Unprocessable Entity"
2025-03-06 06:40:54,709 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 06:40:54,710 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 06:40:54,712 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 200 OK"
2025-03-06 06:40:54,720 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 06:40:54,752 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 06:40:54,755 - ai_service.api.routers.charts - INFO - Creating chart with ID: c8032927-a65f-4974-a570-b3551b3682d0
2025-03-06 06:40:54,755 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID c8032927-a65f-4974-a570-b3551b3682d0
2025-03-06 06:40:54,755 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: c8032927-a65f-4974-a570-b3551b3682d0
2025-03-06 06:40:54,756 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 06:40:54,757 - ai_service.api.routers.charts - INFO - Getting chart with ID: c8032927-a65f-4974-a570-b3551b3682d0
2025-03-06 06:40:54,757 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['c8032927-a65f-4974-a570-b3551b3682d0']
2025-03-06 06:40:54,757 - ai_service.api.routers.charts - INFO - Chart found in global storage: c8032927-a65f-4974-a570-b3551b3682d0
2025-03-06 06:40:54,758 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/c8032927-a65f-4974-a570-b3551b3682d0 "HTTP/1.1 200 OK"
2025-03-06 06:40:54,759 - ai_service.api.routers.charts - INFO - Updating chart with ID: c8032927-a65f-4974-a570-b3551b3682d0, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 06:40:54,760 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/c8032927-a65f-4974-a570-b3551b3682d0 "HTTP/1.1 200 OK"
2025-03-06 06:40:54,762 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/c8032927-a65f-4974-a570-b3551b3682d0 "HTTP/1.1 200 OK"
2025-03-06 06:40:54,763 - ai_service.api.routers.charts - INFO - Getting chart with ID: c8032927-a65f-4974-a570-b3551b3682d0
2025-03-06 06:40:54,763 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 06:40:54,763 - ai_service.api.routers.charts - WARNING - Chart not found: c8032927-a65f-4974-a570-b3551b3682d0
2025-03-06 06:40:54,764 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/c8032927-a65f-4974-a570-b3551b3682d0 "HTTP/1.1 404 Not Found"
2025-03-06 06:40:54,767 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 06:40:54,771 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 06:40:54,773 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 06:40:54,774 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 06:40:54,775 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 06:40:54,778 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 404 Not Found"
2025-03-06 06:40:54,786 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 06:40:54,806 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 06:43:26,216 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate/alt "HTTP/1.1 200 OK"
2025-03-06 06:43:59,900 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate/alt "HTTP/1.1 200 OK"
2025-03-06 06:44:15,338 - root - INFO - Running in local environment
2025-03-06 06:44:15,339 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 06:44:15,356 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 404 Not Found"
2025-03-06 06:45:02,419 - root - INFO - Running in local environment
2025-03-06 06:45:02,419 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 06:45:03,940 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 06:45:03,945 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 06:45:04,447 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 06:45:04,464 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:45:08,686 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 06:45:08,701 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.23s
2025-03-06 06:45:08,705 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:45:09,706 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 06:45:09,710 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=74, cost=$0.0008, time=1.0s
2025-03-06 06:45:09,714 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:45:09,726 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 06:45:09,738 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:45:09,741 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:45:09,749 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:45:09,749 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:45:09,749 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:45:09,749 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:45:09,750 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:45:09,752 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:45:09,757 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:45:09,758 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:45:09,758 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:45:09,758 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:45:09,758 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:45:09,761 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 06:45:09,764 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 06:45:09,764 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 06:45:09,766 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:45:09,774 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:45:09,774 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:45:09,774 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:45:09,774 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:45:09,774 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:45:09,780 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:45:09,785 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:45:09,785 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:45:09,785 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:45:09,785 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:45:09,785 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:45:09,786 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:45:09,791 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:45:09,791 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:45:09,791 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:45:09,791 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:45:09,791 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:45:09,791 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:45:09,795 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:45:09,795 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:45:09,795 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:45:09,795 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:45:09,795 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:45:09,796 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 06:45:09,797 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:45:09,801 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:45:09,801 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:45:09,801 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:45:09,801 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:45:09,802 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:45:09,804 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:45:09,807 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:45:09,807 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:45:09,807 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:45:09,808 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:45:09,808 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:45:09,811 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 06:45:09,813 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 06:45:09,815 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate/alt "HTTP/1.1 200 OK"
2025-03-06 06:45:11,351 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 06:45:11,354 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 06:45:11,383 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 200 OK"
2025-03-06 06:45:11,445 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 06:45:11,549 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 06:45:11,563 - ai_service.api.routers.charts - INFO - Creating chart with ID: 124ca0e0-2675-495d-a58a-b11ade3fe778
2025-03-06 06:45:11,564 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 124ca0e0-2675-495d-a58a-b11ade3fe778
2025-03-06 06:45:11,565 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 124ca0e0-2675-495d-a58a-b11ade3fe778
2025-03-06 06:45:11,569 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 06:45:11,574 - ai_service.api.routers.charts - INFO - Getting chart with ID: 124ca0e0-2675-495d-a58a-b11ade3fe778
2025-03-06 06:45:11,575 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['124ca0e0-2675-495d-a58a-b11ade3fe778']
2025-03-06 06:45:11,575 - ai_service.api.routers.charts - INFO - Chart found in global storage: 124ca0e0-2675-495d-a58a-b11ade3fe778
2025-03-06 06:45:11,580 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/124ca0e0-2675-495d-a58a-b11ade3fe778 "HTTP/1.1 200 OK"
2025-03-06 06:45:11,588 - ai_service.api.routers.charts - INFO - Updating chart with ID: 124ca0e0-2675-495d-a58a-b11ade3fe778, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 06:45:11,614 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/124ca0e0-2675-495d-a58a-b11ade3fe778 "HTTP/1.1 200 OK"
2025-03-06 06:45:11,643 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/124ca0e0-2675-495d-a58a-b11ade3fe778 "HTTP/1.1 200 OK"
2025-03-06 06:45:11,647 - ai_service.api.routers.charts - INFO - Getting chart with ID: 124ca0e0-2675-495d-a58a-b11ade3fe778
2025-03-06 06:45:11,647 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 06:45:11,647 - ai_service.api.routers.charts - WARNING - Chart not found: 124ca0e0-2675-495d-a58a-b11ade3fe778
2025-03-06 06:45:11,650 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/124ca0e0-2675-495d-a58a-b11ade3fe778 "HTTP/1.1 404 Not Found"
2025-03-06 06:45:11,663 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 06:45:11,678 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 06:45:11,686 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 06:45:11,689 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 06:45:11,693 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 06:45:13,086 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 06:45:13,092 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 06:45:13,099 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 06:45:13,111 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 06:45:13,226 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 06:46:36,352 - root - INFO - Running in local environment
2025-03-06 06:46:36,352 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 06:46:36,950 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 06:46:36,953 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 06:46:37,454 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 06:46:37,463 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:46:40,133 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 06:46:40,140 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=2.67s
2025-03-06 06:47:17,795 - root - INFO - Running in local environment
2025-03-06 06:47:17,795 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 06:47:18,785 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 06:47:18,790 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 06:47:19,291 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 06:47:19,296 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:47:23,407 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 06:47:23,418 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.12s
2025-03-06 06:47:23,420 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:47:24,500 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 06:47:24,510 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=74, cost=$0.0008, time=1.09s
2025-03-06 06:47:24,513 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:47:24,524 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 06:47:24,534 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 06:47:24,535 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:47:24,543 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:47:24,543 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:47:24,543 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:47:24,543 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:47:24,543 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:47:24,544 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:47:24,548 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:47:24,548 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:47:24,548 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:47:24,548 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:47:24,548 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:47:24,551 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 06:47:24,553 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 06:47:24,553 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 06:47:24,554 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:47:24,561 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:47:24,561 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:47:24,561 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:47:24,561 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:47:24,561 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:47:24,566 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:47:24,572 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:47:24,572 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:47:24,572 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:47:24,572 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:47:24,572 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:47:24,573 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:47:24,578 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:47:24,578 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:47:24,578 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:47:24,578 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:47:24,578 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:47:24,579 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:47:24,583 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:47:24,583 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:47:24,583 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:47:24,584 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:47:24,584 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:47:24,586 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 06:47:24,587 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:47:24,593 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:47:24,594 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:47:24,594 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:47:24,594 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:47:24,594 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:47:24,597 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 06:47:24,603 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 06:47:24,604 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 06:47:24,604 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 06:47:24,604 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 06:47:24,604 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 06:47:24,610 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 06:47:24,618 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 06:47:24,639 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate/alt "HTTP/1.1 200 OK"
2025-03-06 06:47:26,308 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 06:47:26,312 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 06:47:26,323 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 200 OK"
2025-03-06 06:47:26,343 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 06:47:26,761 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 06:47:26,771 - ai_service.api.routers.charts - INFO - Creating chart with ID: 10d08a43-4766-408c-bf81-d629e5ca6a43
2025-03-06 06:47:26,772 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 10d08a43-4766-408c-bf81-d629e5ca6a43
2025-03-06 06:47:26,773 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 10d08a43-4766-408c-bf81-d629e5ca6a43
2025-03-06 06:47:26,779 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 06:47:26,785 - ai_service.api.routers.charts - INFO - Getting chart with ID: 10d08a43-4766-408c-bf81-d629e5ca6a43
2025-03-06 06:47:26,786 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['10d08a43-4766-408c-bf81-d629e5ca6a43']
2025-03-06 06:47:26,786 - ai_service.api.routers.charts - INFO - Chart found in global storage: 10d08a43-4766-408c-bf81-d629e5ca6a43
2025-03-06 06:47:26,798 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/10d08a43-4766-408c-bf81-d629e5ca6a43 "HTTP/1.1 200 OK"
2025-03-06 06:47:26,805 - ai_service.api.routers.charts - INFO - Updating chart with ID: 10d08a43-4766-408c-bf81-d629e5ca6a43, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 06:47:26,809 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/10d08a43-4766-408c-bf81-d629e5ca6a43 "HTTP/1.1 200 OK"
2025-03-06 06:47:26,819 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/10d08a43-4766-408c-bf81-d629e5ca6a43 "HTTP/1.1 200 OK"
2025-03-06 06:47:26,822 - ai_service.api.routers.charts - INFO - Getting chart with ID: 10d08a43-4766-408c-bf81-d629e5ca6a43
2025-03-06 06:47:26,823 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 06:47:26,823 - ai_service.api.routers.charts - WARNING - Chart not found: 10d08a43-4766-408c-bf81-d629e5ca6a43
2025-03-06 06:47:26,825 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/10d08a43-4766-408c-bf81-d629e5ca6a43 "HTTP/1.1 404 Not Found"
2025-03-06 06:47:26,840 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 06:47:26,851 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 06:47:26,862 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 06:47:26,866 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 06:47:26,872 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 06:47:28,355 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 06:47:28,359 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 06:47:28,368 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 06:47:28,381 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 06:47:28,519 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 07:02:47,836 - root - INFO - Running in local environment
2025-03-06 07:02:47,836 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 07:02:49,250 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 07:02:49,253 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 07:02:49,754 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.5s
2025-03-06 07:02:49,764 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:02:52,914 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 07:02:52,921 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=3.15s
2025-03-06 07:02:52,931 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:02:54,626 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 07:02:54,636 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=55, cost=$0.0005, time=1.7s
2025-03-06 07:02:54,640 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:02:54,645 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 07:02:54,662 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:02:54,664 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:02:54,674 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:02:54,674 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:02:54,674 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:02:54,674 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:02:54,674 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:02:54,675 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:02:54,678 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:02:54,679 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:02:54,679 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:02:54,679 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:02:54,679 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:02:54,680 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 07:02:54,690 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 07:02:54,690 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 07:02:54,691 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:02:54,695 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:02:54,695 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:02:54,695 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:02:54,695 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:02:54,695 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:02:54,698 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:02:54,702 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:02:54,702 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:02:54,702 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:02:54,702 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:02:54,702 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:02:54,702 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:02:54,708 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:02:54,708 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:02:54,708 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:02:54,708 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:02:54,708 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:02:54,709 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:02:54,713 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:02:54,713 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:02:54,713 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:02:54,713 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:02:54,713 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:02:54,714 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 07:02:54,715 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:02:54,718 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:02:54,718 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:02:54,718 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:02:54,718 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:02:54,718 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:02:54,720 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:02:54,724 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:02:54,724 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:02:54,724 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:02:54,724 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:02:54,724 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:02:54,728 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 07:02:54,730 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 07:02:54,732 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate/alt "HTTP/1.1 200 OK"
2025-03-06 07:02:56,410 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 07:02:56,421 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 07:02:56,425 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 200 OK"
2025-03-06 07:02:56,435 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 07:02:58,759 - test_containers - WARNING - Running in CPU mode
2025-03-06 07:02:58,760 - test_containers - INFO - 
Running container stability test...
2025-03-06 07:02:58,761 - test_containers - INFO - Stability check 1/5
2025-03-06 07:02:59,207 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 07:02:59,212 - ai_service.api.routers.charts - INFO - Creating chart with ID: 6b0c5cf9-204f-47cd-b712-f814efcbac48
2025-03-06 07:02:59,213 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 6b0c5cf9-204f-47cd-b712-f814efcbac48
2025-03-06 07:02:59,214 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 6b0c5cf9-204f-47cd-b712-f814efcbac48
2025-03-06 07:02:59,216 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 07:02:59,217 - ai_service.api.routers.charts - INFO - Getting chart with ID: 6b0c5cf9-204f-47cd-b712-f814efcbac48
2025-03-06 07:02:59,217 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['6b0c5cf9-204f-47cd-b712-f814efcbac48']
2025-03-06 07:02:59,218 - ai_service.api.routers.charts - INFO - Chart found in global storage: 6b0c5cf9-204f-47cd-b712-f814efcbac48
2025-03-06 07:02:59,220 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/6b0c5cf9-204f-47cd-b712-f814efcbac48 "HTTP/1.1 200 OK"
2025-03-06 07:02:59,223 - ai_service.api.routers.charts - INFO - Updating chart with ID: 6b0c5cf9-204f-47cd-b712-f814efcbac48, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 07:02:59,227 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/6b0c5cf9-204f-47cd-b712-f814efcbac48 "HTTP/1.1 200 OK"
2025-03-06 07:02:59,230 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/6b0c5cf9-204f-47cd-b712-f814efcbac48 "HTTP/1.1 200 OK"
2025-03-06 07:02:59,231 - ai_service.api.routers.charts - INFO - Getting chart with ID: 6b0c5cf9-204f-47cd-b712-f814efcbac48
2025-03-06 07:02:59,231 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 07:02:59,231 - ai_service.api.routers.charts - WARNING - Chart not found: 6b0c5cf9-204f-47cd-b712-f814efcbac48
2025-03-06 07:02:59,232 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/6b0c5cf9-204f-47cd-b712-f814efcbac48 "HTTP/1.1 404 Not Found"
2025-03-06 07:02:59,235 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 07:02:59,238 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 07:02:59,241 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 07:02:59,242 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 07:02:59,244 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 07:03:00,916 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 07:03:00,921 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 07:03:00,929 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 07:03:00,938 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 07:03:00,983 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 07:07:58,110 - root - INFO - Running in local environment
2025-03-06 07:07:58,110 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 07:07:59,535 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 07:07:59,538 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 07:08:00,054 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.52s
2025-03-06 07:08:00,093 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:08:04,655 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 07:08:04,666 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=4.56s
2025-03-06 07:08:04,676 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:08:06,109 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 07:08:06,122 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=70, cost=$0.0007, time=1.44s
2025-03-06 07:08:06,130 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:08:06,146 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 07:08:06,185 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:08:06,188 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:08:06,203 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:08:06,203 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:08:06,203 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:08:06,204 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:08:06,204 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:08:06,206 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:08:06,218 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:08:06,218 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:08:06,219 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:08:06,219 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:08:06,219 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:08:06,234 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 07:08:06,259 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 07:08:06,260 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 07:08:06,264 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:08:06,275 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:08:06,275 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:08:06,276 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:08:06,276 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:08:06,276 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:08:06,282 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:08:06,293 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:08:06,293 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:08:06,294 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:08:06,294 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:08:06,294 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:08:06,296 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:08:06,319 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:08:06,319 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:08:06,319 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:08:06,319 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:08:06,319 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:08:06,325 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:08:06,335 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:08:06,335 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:08:06,335 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:08:06,335 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:08:06,335 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:08:06,338 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 07:08:06,341 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:08:06,354 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:08:06,354 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:08:06,354 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:08:06,355 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:08:06,355 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:08:06,361 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:08:06,373 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:08:06,374 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:08:06,374 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:08:06,374 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:08:06,374 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:08:06,385 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 07:08:06,392 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 07:08:06,402 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate/alt "HTTP/1.1 200 OK"
2025-03-06 07:08:08,138 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 07:08:08,149 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 07:08:08,170 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 200 OK"
2025-03-06 07:08:08,216 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 07:08:10,983 - test_containers - WARNING - Running in CPU mode
2025-03-06 07:08:10,987 - test_containers - INFO - 
Running container stability test...
2025-03-06 07:08:10,992 - test_containers - INFO - Stability check 1/5
2025-03-06 07:08:13,632 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 07:08:13,644 - ai_service.api.routers.charts - INFO - Creating chart with ID: 7201b15c-98f3-4203-a0ee-61bc95f27972
2025-03-06 07:08:13,647 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 7201b15c-98f3-4203-a0ee-61bc95f27972
2025-03-06 07:08:13,647 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 7201b15c-98f3-4203-a0ee-61bc95f27972
2025-03-06 07:08:13,656 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 07:08:13,661 - ai_service.api.routers.charts - INFO - Getting chart with ID: 7201b15c-98f3-4203-a0ee-61bc95f27972
2025-03-06 07:08:13,661 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['7201b15c-98f3-4203-a0ee-61bc95f27972']
2025-03-06 07:08:13,662 - ai_service.api.routers.charts - INFO - Chart found in global storage: 7201b15c-98f3-4203-a0ee-61bc95f27972
2025-03-06 07:08:13,670 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/7201b15c-98f3-4203-a0ee-61bc95f27972 "HTTP/1.1 200 OK"
2025-03-06 07:08:13,677 - ai_service.api.routers.charts - INFO - Updating chart with ID: 7201b15c-98f3-4203-a0ee-61bc95f27972, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 07:08:13,683 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/7201b15c-98f3-4203-a0ee-61bc95f27972 "HTTP/1.1 200 OK"
2025-03-06 07:08:13,696 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/7201b15c-98f3-4203-a0ee-61bc95f27972 "HTTP/1.1 200 OK"
2025-03-06 07:08:13,701 - ai_service.api.routers.charts - INFO - Getting chart with ID: 7201b15c-98f3-4203-a0ee-61bc95f27972
2025-03-06 07:08:13,702 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 07:08:13,702 - ai_service.api.routers.charts - WARNING - Chart not found: 7201b15c-98f3-4203-a0ee-61bc95f27972
2025-03-06 07:08:13,716 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/7201b15c-98f3-4203-a0ee-61bc95f27972 "HTTP/1.1 404 Not Found"
2025-03-06 07:08:13,745 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 07:08:13,768 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 07:08:13,796 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 07:08:13,810 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 07:08:13,820 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 07:08:15,339 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 07:08:15,346 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 07:08:15,377 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 07:08:15,397 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 07:08:15,491 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 07:17:11,006 - root - INFO - Running in local environment
2025-03-06 07:17:11,006 - root - INFO - Container tests will be skipped unless containers are running (RUN_CONTAINER_TESTS=false)
2025-03-06 07:17:11,733 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-03-06 07:17:11,738 - ai_service.api.services.openai_service - ERROR - Error generating OpenAI completion: Error code: 400 - {'error': {'message': "Unsupported value: 'messages[0].role' does not support 'system' with this model.", 'type': 'invalid_request_error', 'param': 'messages[0].role', 'code': 'unsupported_value'}}
2025-03-06 07:17:12,244 - ai_service.api.services.openai_service - INFO - Generated mock completion for model o1-preview in 0.51s
2025-03-06 07:17:12,249 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:17:20,829 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 07:17:20,856 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4-turbo, tokens=130, cost=$0.0033, time=8.6s
2025-03-06 07:17:20,865 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:17:24,666 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-06 07:17:24,676 - ai_service.api.services.openai_service - INFO - OpenAI API call completed: model=gpt-4o-mini, tokens=78, cost=$0.0009, time=3.81s
2025-03-06 07:17:24,685 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:17:24,703 - httpx - INFO - HTTP Request: GET http://testserver/api/ai/usage_statistics "HTTP/1.1 200 OK"
2025-03-06 07:17:24,738 - httpx - INFO - HTTP Request: POST http://testserver/api/ai/test_model_routing "HTTP/1.1 200 OK"
2025-03-06 07:17:24,740 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:17:24,750 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:17:24,751 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:17:24,751 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:17:24,751 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:17:24,751 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:17:24,753 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:17:24,763 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:17:24,763 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:17:24,764 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:17:24,764 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:17:24,764 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:17:24,768 - ai_service.models.unified_model - INFO - Processing birth time rectification request
2025-03-06 07:17:24,771 - ai_service.models.unified_model - INFO - Using simulated rectification method
2025-03-06 07:17:24,771 - ai_service.models.unified_model - WARNING - OpenAI service not available, using fallback explanation
2025-03-06 07:17:24,772 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:17:24,779 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:17:24,780 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:17:24,780 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:17:24,780 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:17:24,780 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:17:24,786 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:17:24,793 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:17:24,793 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:17:24,793 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:17:24,794 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:17:24,794 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:17:24,798 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:17:24,809 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:17:24,810 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:17:24,810 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:17:24,810 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:17:24,810 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:17:24,814 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:17:24,823 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:17:24,824 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:17:24,825 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:17:24,825 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:17:24,825 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:17:24,833 - ai_service.models.unified_model - INFO - Explanation generated. Tokens used: 12
2025-03-06 07:17:24,834 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:17:24,844 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:17:24,846 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:17:24,846 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:17:24,846 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:17:24,846 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:17:24,853 - ai_service.models.unified_model - INFO - Initializing Unified Rectification Model
2025-03-06 07:17:24,862 - ai_service.api.services.openai_service - INFO - OpenAI service initialized
2025-03-06 07:17:24,863 - ai_service.models.unified_model - INFO - OpenAI service initialized successfully
2025-03-06 07:17:24,863 - ai_service.utils.gpu_manager - WARNING - No GPU detected, using CPU
2025-03-06 07:17:24,863 - ai_service.models.unified_model - INFO - GPU memory manager initialized
2025-03-06 07:17:24,863 - ai_service.models.unified_model - INFO - Model initialized successfully (version 1.0.0)
2025-03-06 07:17:24,872 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 07:17:24,882 - httpx - INFO - HTTP Request: GET http://testserver/api/health "HTTP/1.1 200 OK"
2025-03-06 07:17:24,891 - httpx - INFO - HTTP Request: POST http://testserver/chart/generate/alt "HTTP/1.1 200 OK"
2025-03-06 07:17:26,688 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 07:17:26,695 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 07:17:26,700 - httpx - INFO - HTTP Request: GET http://testserver/geocode?query=New+York "HTTP/1.1 200 OK"
2025-03-06 07:17:26,711 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/generate "HTTP/1.1 200 OK"
2025-03-06 07:17:27,441 - test_containers - WARNING - Running in CPU mode
2025-03-06 07:17:27,444 - test_containers - INFO - 
Running container stability test...
2025-03-06 07:17:27,445 - test_containers - INFO - Stability check 1/5
2025-03-06 07:17:27,717 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-03-06 07:17:27,722 - ai_service.api.routers.charts - INFO - Creating chart with ID: 9b347513-1ff6-43e9-84b2-1d81c84befe2
2025-03-06 07:17:27,723 - ai_service.api.routers.charts - INFO - Replacing original chart ID chart_1 with new UUID 9b347513-1ff6-43e9-84b2-1d81c84befe2
2025-03-06 07:17:27,723 - ai_service.api.routers.charts - INFO - Chart created and stored with ID: 9b347513-1ff6-43e9-84b2-1d81c84befe2
2025-03-06 07:17:27,725 - httpx - INFO - HTTP Request: POST http://testserver/api/charts "HTTP/1.1 200 OK"
2025-03-06 07:17:27,727 - ai_service.api.routers.charts - INFO - Getting chart with ID: 9b347513-1ff6-43e9-84b2-1d81c84befe2
2025-03-06 07:17:27,727 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: ['9b347513-1ff6-43e9-84b2-1d81c84befe2']
2025-03-06 07:17:27,727 - ai_service.api.routers.charts - INFO - Chart found in global storage: 9b347513-1ff6-43e9-84b2-1d81c84befe2
2025-03-06 07:17:27,730 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/9b347513-1ff6-43e9-84b2-1d81c84befe2 "HTTP/1.1 200 OK"
2025-03-06 07:17:27,733 - ai_service.api.routers.charts - INFO - Updating chart with ID: 9b347513-1ff6-43e9-84b2-1d81c84befe2, data: {'notes': 'Updated test chart notes', 'tags': ['test', 'end-to-end']}
2025-03-06 07:17:27,738 - httpx - INFO - HTTP Request: PUT http://testserver/api/charts/9b347513-1ff6-43e9-84b2-1d81c84befe2 "HTTP/1.1 200 OK"
2025-03-06 07:17:27,741 - httpx - INFO - HTTP Request: DELETE http://testserver/api/charts/9b347513-1ff6-43e9-84b2-1d81c84befe2 "HTTP/1.1 200 OK"
2025-03-06 07:17:27,743 - ai_service.api.routers.charts - INFO - Getting chart with ID: 9b347513-1ff6-43e9-84b2-1d81c84befe2
2025-03-06 07:17:27,743 - ai_service.api.routers.charts - INFO - Available chart IDs in global storage: []
2025-03-06 07:17:27,743 - ai_service.api.routers.charts - WARNING - Chart not found: 9b347513-1ff6-43e9-84b2-1d81c84befe2
2025-03-06 07:17:27,746 - httpx - INFO - HTTP Request: GET http://testserver/api/charts/9b347513-1ff6-43e9-84b2-1d81c84befe2 "HTTP/1.1 404 Not Found"
2025-03-06 07:17:27,750 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/initialize "HTTP/1.1 200 OK"
2025-03-06 07:17:27,753 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 07:17:27,758 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/answer "HTTP/1.1 200 OK"
2025-03-06 07:17:27,760 - ai_service.api.routers.questionnaire - WARNING - Model not initialized, using mock model for tests
2025-03-06 07:17:27,765 - httpx - INFO - HTTP Request: POST http://testserver/api/questionnaire/analyze "HTTP/1.1 200 OK"
2025-03-06 07:17:29,085 - httpx - INFO - HTTP Request: GET https://nominatim.openstreetmap.org/search?q=New%20York&format=json&limit=1&addressdetails=1 "HTTP/1.1 200 OK"
2025-03-06 07:17:29,088 - ai_service.api.routers.geocode - WARNING - TIMEZONE_API_KEY not set. Using UTC as fallback.
2025-03-06 07:17:29,098 - httpx - INFO - HTTP Request: GET http://testserver/api/geocoding/geocode?query=New%20York "HTTP/1.1 200 OK"
2025-03-06 07:17:29,107 - httpx - INFO - HTTP Request: GET http://testserver/docs "HTTP/1.1 200 OK"
2025-03-06 07:17:29,156 - httpx - INFO - HTTP Request: GET http://testserver/openapi.json "HTTP/1.1 200 OK"
2025-03-06 07:17:29,304 - test_ui_flow - INFO - API Response: {'originalTime': '12:00', 'suggestedTime': '12:01', 'confidence': 85, 'reliability': 'high', 'explanation': 'Test rectification based on provided data'}
